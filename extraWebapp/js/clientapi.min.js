LABKEY.initExtAdapter=function(B,A){if(!A){return }A.ns("LABKEY.ExtAdapter");A.apply(B.ExtAdapter,{Ajax:A.Ajax,apply:A.apply,applyIf:A.applyIf,decode:A.JSON?A.JSON.decode:A.util.JSON.decode,DomHelper:A.DomHelper,each:A.each,encode:A.JSON?A.JSON.encode:A.util.JSON.encode,EventManager:A.EventManager,extend:A.extend,Format:A.util.Format,get:A.get,htmlEncode:A.util.Format.htmlEncode,isArray:A.isArray,isDefined:A.isDefined,isEmpty:A.isEmpty,isFunction:A.isFunction,isGecko:A.isGecko,isIE:A.isIE,isObject:A.isObject,isPrimitive:A.isPrimitive,isString:A.isString,Msg:A.Msg,namespace:A.ns,ns:A.ns,onReady:A.onReady,query:A.query})};LABKEY.inferHighestExtVersion=function(){if(window.Ext4){return Ext4}else{if(window.Ext){return Ext}}console.warn("A known version of ExtJS cannot be found. Some features of this page may not work correctly.")};LABKEY.initExtAdapter(LABKEY,LABKEY.inferHighestExtVersion());LABKEY.Utils=new function(){var D="0123456789abcdefghijklmnopqrstuvwxyz".split("");var B="n/j/y g:i:s a|n/j/Y g:i:s a|n/j/y G:i:s|n/j/Y G:i:s|n-j-y g:i:s a|n-j-Y g:i:s a|n-j-y G:i:s|n-j-Y G:i:s|n/j/y g:i a|n/j/Y g:i a|n/j/y G:i|n/j/Y G:i|n-j-y g:i a|n-j-Y g:i a|n-j-y G:i|n-j-Y G:i|j-M-y g:i a|j-M-Y g:i a|j-M-y G:i|j-M-Y G:i|n/j/y|n/j/Y|n-j-y|n-j-Y|j-M-y|j-M-Y|Y-n-d H:i:s|Y-n-d|Y/n/d H:i:s|Y/n/d|j M Y G:i:s O|j M Y H:i:s|c";function A(F){return typeof F=="object"&&Object.prototype.toString.call(F)==="[object Object]"}function E(H,G){if(G==0||!A(H)){return H}var I={};for(var F in H){I[F]=E(H[F],G-1)}return I}function C(J,I,F,H){for(var G in I){if(A(J[G])&&A(I[G])){C(J[G],I[G],F,H-1)}else{if(undefined===J[G]||F){J[G]=E(I[G],H-1)}}}}return{encodeHtml:function(F){var H=document.createElement("div");var G=document.createTextNode(F);H.appendChild(G);return H.innerHTML},isArray:function(F){return Object.prototype.toString.call(F)==="[object Array]"},isDefined:function(F){return typeof F!=="undefined"},isFunction:function(F){var G={};return F&&G.toString.call(F)==="[object Function]"},getDateAltFormats:function(){return B},displayAjaxErrorResponse:function(F,J,I,H){if(F.status==0){return }var G=LABKEY.Utils.getMsgFromError(F,J,{msgPrefix:H,showExceptionClass:I});alert(LABKEY.Utils.encodeHtml(G))},getMsgFromError:function(F,K,I){I=I||{};var H;var J=I.msgPrefix||"An error occurred trying to load:\n";if(F&&F.responseText&&F.getResponseHeader("Content-Type")&&F.getResponseHeader("Content-Type").indexOf("application/json")>=0){var G=LABKEY.ExtAdapter.decode(F.responseText);if(G&&G.exception){H=J+G.exception;if(I.showExceptionClass){H+="\n("+(G.exceptionClass?G.exceptionClass:"Exception class unknown")+")"}}}if(!H){H=J+"Status: "+F.statusText+" ("+F.status+")"}if(K&&K.message){H+="\n"+K.name+": "+K.message}return H},resizeToViewport:function(K,H,G,J,I,F,L){console.warn("LABKEY.Utils.resizeToViewport has been migrated. See JavaScript API documentation for details.")},getFileIconUrl:function(H){var F=H.lastIndexOf(".");var G=(F>=0)?H.substring(F+1):"_generic";return LABKEY.ActionURL.buildURL("core","getAttachmentIcon","",{extension:G})},convertToExcel:function(F){var G=LABKEY.ExtAdapter.DomHelper.append(document.getElementsByTagName("body")[0],'<form method="POST" action="'+LABKEY.ActionURL.buildURL("experiment","convertArraysToExcel")+'"><input type="hidden" name="json" value="'+LABKEY.ExtAdapter.htmlEncode(LABKEY.ExtAdapter.encode(F))+'" /></form>');G.submit()},convertToTable:function(F){var G=LABKEY.ExtAdapter.DomHelper.append(document.getElementsByTagName("body")[0],'<form method="POST" action="'+LABKEY.ActionURL.buildURL("experiment","convertArraysToTable")+'"><input type="hidden" name="json" value="'+LABKEY.ExtAdapter.htmlEncode(LABKEY.ExtAdapter.encode(F))+'" /></form>');G.submit()},getCallbackWrapper:function(H,G,F){return function(I,K){var L=I.responseJSON;if(!L){if(I&&I.getResponseHeader&&I.getResponseHeader("Content-Type")&&I.getResponseHeader("Content-Type").indexOf("application/json")>=0){try{L=LABKEY.ExtAdapter.decode(I.responseText)}catch(J){}}I.responseJSON=L}if(!L&&F){L=new Object()}if(L&&!L.exception&&F){L.exception=(I&&I.statusText?I.statusText:"Communication failure.")}if(H){H.call(G||this,L,I,K)}else{if(F&&I.status!=0){LABKEY.ExtAdapter.Msg.alert("Error",L.exception)}}}},applyTranslated:function(J,I,G,H,K){if(undefined===J){J={}}if(undefined===H){H=true}if(undefined==K&&H){K=true}var F;for(var L in I){if(L=="constructor"||LABKEY.Utils.isFunction(L)){continue}F=G[L];if(F){J[G[L]]=I[L]}else{if(undefined===F&&H&&(K||!LABKEY.Utils.isFunction(I[L]))){J[L]=I[L]}}}},setCookie:function(I,K,H,M){var F;if(M){var G=new Date();G.setTime(G.getTime()+(M*24*60*60*1000));F="; expires="+G.toGMTString()}else{F=""}var L="/";if(H){L=location.pathname.substring(0,location.pathname.lastIndexOf("/"))}var J=I+"="+K+F+"; path="+L;document.cookie=J},getCookie:function(G,I){var J=G+"=";var F=document.cookie.split(";");for(var H=0;H<F.length;H++){var K=F[H];while(K.charAt(0)==" "){K=K.substring(1,K.length)}if(K.indexOf(J)==0){return K.substring(J.length,K.length)}}return I},deleteCookie:function(G,F){LABKEY.Utils.setCookie(G,"",F,-1)},requiresScript:function(G,F){LABKEY.requiresScript(G,F)},requiresCSS:function(F){LABKEY.requiresCss(F)},endsWith:function(G,F){if(!G||!F){return false}if(G.length<F.length){return false}return G.substring(G.length-F.length)==F},onTrue:function(F){F.maxTests=F.maxTests||1000;try{if(F.testCallback.apply(F.scope||this,F.testArguments||[])){LABKEY.Utils.getOnSuccess(F).apply(F.scope||this,F.successArguments||[])}else{if(F.maxTests<=0){throw"Maximum number of tests reached!"}else{--F.maxTests;LABKEY.Utils.onTrue.defer(10,this,[F])}}}catch(G){if(LABKEY.Utils.getOnFailure(F)){LABKEY.Utils.getOnFailure(F).apply(F.scope||this,[G,F.errorArguments])}}},ensureBoxVisible:function(){console.warn("LABKEY.Utils.ensureBoxVisible has been migrated to the appropriate Ext scope. Consider LABKEY.ext.Utils.ensureBoxVisible or LABKEY.ext4.Util.ensureBoxVisible")},generateUUID:function(){if(LABKEY&&LABKEY.uuids&&LABKEY.uuids.length>0){return LABKEY.uuids.pop()}var J=D,H=new Array(36),G=0,I;for(var F=0;F<36;F++){if(F==8||F==13||F==18||F==23){H[F]="-"}else{if(F==14){H[F]="4"}else{if(G<=2){G=33554432+(Math.random()*16777216)|0}I=G&15;G=G>>4;H[F]=J[(F==19)?(I&3)|8:I]}}}return H.join("")},textLink:function(G){if(G.href===undefined&&!G.onClick===undefined){throw"href AND/OR onClick required in call to LABKEY.Utils.textLink()"}var F=" ";if(G){for(var H in G){if(G.hasOwnProperty(H)){if(H.toString()!="text"&&H.toString()!="class"){F+=H.toString()+'="'+G[H]+'" '}}}return'<a class="labkey-text-link"'+F+">"+(G.text!=null?G.text:"")+"</a>"}throw"Config object not found for textLink."},getOnFailure:function(F){return F.failure||F.errorCallback||F.failureCallback},getOnSuccess:function(F){return F.success||F.successCallback},merge:function(G,F,J){var I=G;for(var H=1;H<arguments.length;H++){C(I,arguments[H],true,50)}return I},mergeIf:function(G,F,J){var I=arguments[0];for(var H=1;H<arguments.length;H++){C(I,arguments[H],false,50)}return I},onError:function(F){LABKEY.ExtAdapter.Msg.hide();if(!F){return }console.log("ERROR: "+F.exception);console.log(F);if(!F.noAuditLog){LABKEY.Query.insertRows({containerPath:F.containerPath||"/shared",schemaName:"auditlog",queryName:"Client API Actions",rows:[{EventType:"Client API Actions",Key1:"Client Error",Key2:window.location.href,Key3:(F.stackTrace&&LABKEY.Utils.isArray(F.stackTrace)?F.stackTrace.join("\n"):null),Comment:(F.exception||F.statusText||F.message),Date:new Date()}],success:function(){console.log("Error successfully logged")},failure:function(G){console.log("Problem logging error");console.log(G)}})}},isEmptyObj:function(F){for(var G in F){return false}return true},roundNumber:function(F,G){return Math.round(F*Math.pow(10,G))/Math.pow(10,G)},padString:function(G,I,J){if(typeof G!="string"){G=G.toString()}var F="";if(I>G.length){for(var H=0;H<(I-G.length);H++){F+=J}}return F+G},caseInsensitiveEquals:function(G,F){G=String(G);F=String(F);return G.toLowerCase()==F.toLowerCase()},setWebpartTitle:function(G,H){var F=LABKEY.ExtAdapter.query("table#webpart_"+H+" span[class=labkey-wp-title-text]");if(F&&(F.length>=1)){F[0].innerHTML=LABKEY.Utils.encodeHtml(G)}},isBoolean:function(G){var F=G.toString().toUpperCase();if(F=="TRUE"||G=="1"||F=="Y"||F=="YES"||F=="ON"||F=="T"||F=="FALSE"||G=="0"||F=="N"||F=="NO"||F=="OFF"||F=="F"){return true}},onReady:function(G){var H;var I;var F;if(LABKEY.Utils.isFunction(G)){H=this;I=G;F=null}else{if(LABKEY.ExtAdapter.isObject(G)&&LABKEY.Utils.isFunction(G.callback)){H=G.scope||this;I=G.callback;F=G.scripts}else{alert("Improper configuration for LABKEY.onReady()");return }}if(F){LABKEY.requiresScript(F,true,I,H,true)}else{LABKEY.ExtAdapter.onReady(I,H)}},loadAjaxContent:function(F,K,L,I){var H=LABKEY.ExtAdapter.decode(F.responseText);if(!H){return }if(H.moduleContext){LABKEY.applyModuleContext(H.moduleContext)}if(H.requiredCssScripts){LABKEY.requiresCss(H.requiredCssScripts)}if(H.implicitCssIncludes){for(var G=0;G<H.implicitCssIncludes.length;G++){LABKEY.requestedCssFiles(H.implicitCssIncludes[G])}}if(H.requiredJsScripts&&H.requiredJsScripts.length){LABKEY.requiresScript(H.requiredJsScripts,true,J,this,true)}else{J()}if(H.implicitJsIncludes){LABKEY.loadedScripts(H.implicitJsIncludes)}function J(){if(H.html){K.update(H.html,true,function(){if(L){L.call(I||window)}})}}}}};LABKEY.ActionURL=new function(){var C=A(window.location.pathname);function D(K){if(!K&&LABKEY.postParameters){return LABKEY.postParameters}if(!K){K=window.location.search}if(K.charAt(0)=="?"){K=K.substring(1,K.length)}var F=K.split("&");var I={};for(var H=0;H<F.length;H++){var E=F[H].split("=",2);if(E.length==1&&E[0]!=""){E[1]=""}if(E.length==2){var G=decodeURIComponent(E[0]);if(undefined==I[G]){I[G]=decodeURIComponent(E[1])}else{var J=I[G];if(LABKEY.Utils.isArray(J)){J.push(decodeURIComponent(E[1]))}else{I[G]=[J,decodeURIComponent(E[1])]}}}}return I}function B(G,H){var E=G.split("/");for(var F=0;F<E.length;F++){E[F]=H(E[F])}return E.join("/")}function A(J){var L=LABKEY.contextPath.length;var F=J.lastIndexOf("/");var I=J.substring(F+1);J=J.substring(L,F);var E=null;var K=I.indexOf("-");if(0<K){E=I.substring(0,K);I=I.substring(K+1)}else{var H=J.indexOf("/",1);E=J.substring(1,H);J=J.substring(H)}var G=I.indexOf(".");if(0<G){I=I.substring(0,G)}return{controller:decodeURIComponent(E),action:decodeURIComponent(I),containerPath:decodeURI(J)}}return{getContextPath:function(){return LABKEY.contextPath},getAction:function(){return C.action},getContainer:function(E){if(LABKEY.container&&LABKEY.container.path){return LABKEY.container.path}return C.containerPath},getContainerName:function(){var E=LABKEY.ActionURL.getContainer();var F=E.lastIndexOf("/");return E.substring(F+1)},getController:function(){return C.controller},getParameter:function(E){var F=D()[E];return(F&&LABKEY.Utils.isArray(F)&&F.length>0)?F[0]:F},getParameterArray:function(E){var F=D()[E];return(F&&!LABKEY.Utils.isArray(F))?[F]:F},getParameters:function(E){var F;if(!E){return D(E)}if(E.indexOf("?")!=-1){F=E.substring(E.indexOf("?")+1,E.length)}else{F=E}return D(F)},buildURL:function(E,I,F,G){if(!F){F=this.getContainer()}F=LABKEY.ActionURL.encodePath(F);if(F.charAt(0)!="/"){F="/"+F}if(F.charAt(F.length-1)!="/"){F=F+"/"}if(-1==I.indexOf(".")){I+=".view"}var H=LABKEY.ActionURL.queryString(G);var J;if(LABKEY.experimentalContainerRelativeURL){J=LABKEY.contextPath+F+E+"-"+I}else{J=LABKEY.contextPath+"/"+E+F+I}if(H){J+="?"+H}return J},encodePath:function(E){return B(E,encodeURIComponent)},decodePath:function(E){return B(E,decodeURIComponent)},queryString:function(H){if(!H){return""}var I="";var G="";for(var J in H){var F=H[J];if(LABKEY.Utils.isArray(F)){for(var E=0;E<F.length;++E){I+=G+encodeURIComponent(J)+"="+encodeURIComponent(F[E]);G="&"}}else{I+=G+encodeURIComponent(J)+"="+encodeURIComponent(F);G="&"}}return I},getBaseURL:function(E){return window.location.protocol+"//"+window.location.host+(E?"":LABKEY.ActionURL.getContextPath()+"/")}}};LABKEY.Assay=new function(){function C(D){if(arguments.length>1){D={success:arguments[0],failure:arguments[1],parameters:arguments[2],containerPath:arguments[3]}}B(D,"id");B(D,"type");B(D,"name");LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("assay","assayList",D.containerPath),method:"POST",success:LABKEY.Utils.getOnSuccess(D),failure:LABKEY.Utils.getOnFailure(D),scope:D.scope||this,jsonData:D.parameters,headers:{"Content-Type":"application/json"}})}function A(D,E){return LABKEY.Utils.getCallbackWrapper(function(G,F){if(D){D.call(this,G.definitions,F)}},(E||this))}function B(D,E){if(!D.parameters){D.parameters={}}if(D[E]){D.parameters[E]=D[E];delete D[E]}}return{getAll:function(D){if(arguments.length>1){D={success:arguments[0],failure:arguments[1],parameters:{},containerPath:arguments[2]}}D.success=A(LABKEY.Utils.getOnSuccess(D),D.scope);C(D)},getByName:function(D){if(arguments.length>1){D={success:arguments[0],failure:arguments[1],parameters:{name:arguments[2]},containerPath:arguments[3]}}B(D,"name");D.success=A(LABKEY.Utils.getOnSuccess(D),D.scope);C(D)},getByType:function(D){if(arguments.length>1){D={success:arguments[0],failure:arguments[1],parameters:{type:arguments[2]},containerPath:arguments[3]}}B(D,"type");D.success=A(LABKEY.Utils.getOnSuccess(D),D.scope);C(D)},getById:function(D){if(arguments.length>1){D={success:arguments[0],failure:arguments[1],parameters:{id:arguments[2]},containerPath:arguments[3]}}B(D,"id");D.success=A(LABKEY.Utils.getOnSuccess(D),D.scope);C(D)},getNAbRuns:function(F){var G={};LABKEY.Utils.merge(G,F);if(F.sort){G["query.sort"]=F.sort}if(F.offset){G["query.offset"]=F.offset}if(F.maxRows){if(F.maxRows<0){G["query.showRows"]="all"}else{G["query.maxRows"]=F.maxRows}}LABKEY.Filter.appendFilterParams(G,F.filterArray);var D=LABKEY.Utils.getOnSuccess(F);var E={url:LABKEY.ActionURL.buildURL("nabassay","getNabRuns",F.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(function(I,H){if(D){D.call(F.scope,I.runs)}},this),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(F),F.scope,true),params:G};if(LABKEY.Utils.isDefined(F.timeout)){E.timeout=F.timeout}LABKEY.Ajax.request(E)},getStudyNabRuns:function(F){var G={};LABKEY.Utils.merge(G,F);var D=LABKEY.Utils.getOnSuccess(F);var E={url:LABKEY.ActionURL.buildURL("nabassay","getStudyNabRuns",F.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(function(I,H){if(D){D.call(F.scope,I.runs)}},this),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(F)||LABKEY.Utils.displayAjaxErrorResponse,F.scope,true),params:G};if(LABKEY.Utils.isDefined(F.timeout)){E.timeout=F.timeout}LABKEY.Ajax.request(E)},getStudyNabGraphURL:function(E){var F={};LABKEY.Utils.applyTranslated(F,E,{objectIds:"id"},true,false);var D={url:LABKEY.ActionURL.buildURL("nabassay","getStudyNabGraphURL",E.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(E),E.scope,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(E)||LABKEY.Utils.displayAjaxErrorResponse,E.scope,true),params:F};if(LABKEY.Utils.isDefined(E.timeout)){D.timeout=E.timeout}LABKEY.Ajax.request(D)},importRun:function(H){if(window.FormData){var E=[];if(H.files){for(var L=0;L<H.files.length;L++){var M=H.files[L];if(M instanceof window.File){E.push(M)}else{if(M.tagName=="INPUT"){for(var K=0;K<M.files.length;K++){E.push(M.files[K])}}}}}if(E.length==0){throw new Error("At least one file is required")}var I=new window.FormData();I.append("assayId",H.assayId);I.append("name",H.name);I.append("comment",H.comment);if(H.batchId){I.append("batchId",H.batchId)}if(H.properties){for(var R in H.properties){I.append("properties['"+R+"']",H.properties[R])}}if(H.batchProperties){for(var R in H.batchProperties){I.append("batchProperties['"+R+"']",H.batchProperties[R])}}I.append("file",E[0]);for(var L=1;L<E.length;L++){I.append("file"+L,E[L])}var S=LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(H),H.scope,false);var G=LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(H),H.scope,true);var T=new XMLHttpRequest();T.open("POST",LABKEY.ActionURL.buildURL("assay","importRun",H.containerPath));T.onprogress=function(U){if(U.lengthComputable){var V=U.loaded/U.total;console.log("  percent complete: "+(100*V)+" ...")}else{console.log("  loading ...")}};T.onerror=function(U){G.call(H.scope||this)};T.onload=function(U){if(U.target.status===200){S.call(H.scope||window,T)}else{G.call(H.scope||window,T)}};T.send(I)}else{var J=[];if(H.files){for(var L=0;L<H.files.length;L++){var M=H.files[L];if(M.tagName=="INPUT"){J.push(M)}}}if(J.length==0){throw new Error("At least one file input is required")}var Q={assayId:H.assayId,name:H.name,comment:H.comment};if(H.batchId){Q.batchId=H.batchId}if(H.properties){for(var R in H.properties){Q["properties['"+R+"']"]=H.properties[R]}}if(H.batchProperties){for(var R in H.batchProperties){Q["batchProperties['"+R+"']"]=H.batchProperties[R]}}var F=document.createElement("form");var P=[];for(var L=0;L<J.length;L++){var D="file";if(L>0){D=D+L}var O=J[L];var N=O.cloneNode();O.parentElement.insertBefore(N,O);P.push(N);O.originalName=O.name;O.name=D;F.appendChild(O)}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("assay","importRun",H.containerPath),isUpload:true,method:"POST",params:Q,form:F,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(H),H.scope,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(H),H.scope,true),callback:function(W,Y,V){for(var X=0;X<J.length;X++){var U=J[X];U.name=U.originalName;var Z=P[X];Z.parentElement.insertBefore(U,Z);Z.parentElement.removeChild(Z)}}})}}}};LABKEY.Ajax=new function(){return{request:function(A){var B=LABKEY.ExtAdapter.Ajax.request(A);if(LABKEY.ExtAdapter.isObject(B)){return B.responseJSON||B.responseXML||B.responseText}return B}}};LABKEY.Chart=function(F){this.config=F||{};var C=F.renderTo;var E=F.renderImageMapTo;var D=F.containerPath;var B=function(H,G){LABKEY.Utils.displayAjaxErrorResponse(H)};var A=function(G,H){var I=LABKEY.ExtAdapter.decode(G.responseText);if(E&&I.imageMap){LABKEY.ExtAdapter.DomHelper.append(C,{tag:"img",src:I.imageURL,usemap:E});LABKEY.ExtAdapter.DomHelper.append(E,I.imageMap)}else{LABKEY.ExtAdapter.DomHelper.append(C,{tag:"img",src:I.imageURL})}};return{render:function(){if(!F.schemaName||!F.queryName){console.error("Configuration Error: config.schemaName and config.queryName are required parameters");return }if(!C){F.error("Configuration Error: config.renderTo is a required parameter.");return }if(E){F.imageMapName=E}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("reports","plotChartApi",D),success:A,failure:LABKEY.Utils.getOnFailure(F)||B,params:F})}}};LABKEY.Chart.XY="1";LABKEY.Chart.TIME="2";LABKEY.Domain=new function(){function B(G,E,F,D){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("property","createDomain",D),method:"POST",success:LABKEY.Utils.getCallbackWrapper(G),failure:LABKEY.Utils.getCallbackWrapper(E,this,true),jsonData:F,headers:{"Content-Type":"application/json"}})}function A(G,E,F,D){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("property","getDomain",D),method:"GET",success:LABKEY.Utils.getCallbackWrapper(G),failure:LABKEY.Utils.getCallbackWrapper(E,this,true),params:F})}function C(G,E,F,D){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("property","saveDomain",D),method:"POST",success:LABKEY.Utils.getCallbackWrapper(G),failure:LABKEY.Utils.getCallbackWrapper(E,this,true),jsonData:F,headers:{"Content-Type":"application/json"}})}return{create:function(H,F,G,I,E,D){B(H,F,{kind:G,domainDesign:I,options:E},D)},get:function(G,E,H,F,D){A(G,E,{schemaName:H,queryName:F},D)},save:function(G,E,I,H,F,D){C(G,E,{domainDesign:I,schemaName:H,queryName:F},D)}}};LABKEY.Experiment=new function(){function A(B,D,C){return function(F,G){var H=null;var E=null;if(F&&F.getResponseHeader&&F.getResponseHeader("Content-Type")&&F.getResponseHeader("Content-Type").indexOf("application/json")>=0){H=LABKEY.ExtAdapter.decode(F.responseText);E=B(H)}if(D){D.call(C||this,E,F)}}}return{createHiddenRunGroup:function(B){if(!LABKEY.Utils.getOnSuccess(B)){alert("You must specify a callback function in config.success when calling LABKEY.Exp.createHiddenRunGroup()!");return }function C(D){return new LABKEY.Exp.RunGroup(D)}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("experiment","createHiddenRunGroup",B.containerPath),method:"POST",jsonData:{runIds:B.runIds},success:A(C,LABKEY.Utils.getOnSuccess(B),B.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(B),B.scope,true),headers:{"Content-Type":"application/json"}})},loadBatch:function(B){if(!LABKEY.Utils.getOnSuccess(B)){console.error("You must specify a callback function in config.success when calling LABKEY.Exp.loadBatch()!");return }function C(D){return new LABKEY.Exp.RunGroup(D.batch)}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("assay","getAssayBatch",LABKEY.ActionURL.getContainer()),method:"POST",success:A(C,LABKEY.Utils.getOnSuccess(B),B.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(B),B.scope,true),scope:B.scope,jsonData:{assayId:B.assayId,batchId:B.batchId},headers:{"Content-Type":"application/json"}})},saveBatch:function(B){if(!LABKEY.Utils.getOnSuccess(B)){console.error("You must specify a callback function in config.success when calling LABKEY.Exp.saveBatch()!");return }function C(D){return new LABKEY.Exp.RunGroup(D.batch)}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("assay","saveAssayBatch",LABKEY.ActionURL.getContainer()),method:"POST",jsonData:{assayId:B.assayId,batch:B.batch},success:A(C,LABKEY.Utils.getOnSuccess(B),B.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(B),B.scope,true),scope:B.scope,headers:{"Content-Type":"application/json"}})},saveMaterials:function(B){if(!LABKEY.Utils.getOnSuccess(B)){console.error("You must specify a callback function in config.success when calling LABKEY.Exp.saveBatch()!");return }LABKEY.Query.insertRows({schemaName:"Samples",queryName:B.name,rows:B.materials,success:LABKEY.Utils.getOnSuccess(B),failure:LABKEY.Utils.getOnFailure(B),scope:B.scope})}}};if(typeof LABKEY.Exp=="undefined"){LABKEY.Exp={}}LABKEY.Exp.ExpObject=function(A){A=A||{};this.lsid=A.lsid;this.name=A.name;this.id=A.id||A.rowId;this.rowId=this.id;this.comment=A.comment;this.created=A.created;this.createdBy=A.createdBy;this.modified=A.modified;this.modifiedBy=A.modifiedBy;this.properties=A.properties||{}};LABKEY.Exp.Run=function(A){LABKEY.Exp.ExpObject.call(this,A);A=A||{};this.experiments=A.experiments||[];this.protocol=A.protocol;this.filePathRoot=A.filePathRoot;this.dataInputs=[];if(A.dataInputs){for(var B=0;B<A.dataInputs.length;B++){this.dataInputs.push(new LABKEY.Exp.Data(A.dataInputs[B]))}}this.dataOutputs=A.dataOutputs||[];this.dataRows=A.dataRows||[];this.materialInputs=A.materialInputs||[];this.materialOutputs=A.materialOutputs||[];this.objectProperties=A.objectProperties||{}};LABKEY.Exp.Run.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.Run.prototype.constructor=LABKEY.Exp.Run;LABKEY.Exp.Run.prototype.deleteRun=function(A){if(!LABKEY.Utils.getOnSuccess(A)){console.error("You must specify a callback function in config.success when calling LABKEY.Exp.Run.deleteRun()!");return }LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("experiment","deleteRun"),method:"POST",params:{runId:this.id},success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),this,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),this,true)})};LABKEY.Exp.Protocol=function(A){LABKEY.Exp.ExpObject.call(this,A);A=A||{};this.instrument=A.instrument;this.software=A.software;this.contact=A.contact;this.childProtocols=A.childProtocols||[];this.steps=A.steps||[];this.applicationType=A.applicationType;this.description=A.description;this.runs=[];if(A.runs){for(var B=0;B<A.runs.length;B++){this.runs.push(new LABKEY.Exp.Run(A.runs[B]))}}};LABKEY.Exp.Protocol.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.Protocol.prototype.constructor=LABKEY.Exp.Protocol;LABKEY.Exp.RunGroup=function(A){LABKEY.Exp.ExpObject.call(this,A);A=A||{};this.batchProtocolId=A.batchProtocolId||0;this.runs=[];if(A.runs){for(var B=0;B<A.runs.length;B++){this.runs.push(new LABKEY.Exp.Run(A.runs[B]))}}this.hidden=A.hidden};LABKEY.Exp.RunGroup.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.RunGroup.prototype.constructor=LABKEY.Exp.RunGroup;LABKEY.Exp.ProtocolApplication=function(A){LABKEY.Exp.ExpObject.call(this,A);A=A||{}};LABKEY.Exp.ProtocolApplication.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.ProtocolApplication.prototype.constructor=LABKEY.Exp.ProtocolApplication;LABKEY.Exp.SampleSet=function(A){LABKEY.Exp.ExpObject.call(this,A);A=A||{};this.samples=A.samples;this.description=A.description};LABKEY.Exp.SampleSet.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.SampleSet.prototype.constructor=LABKEY.Exp.SampleSet;LABKEY.Exp.SampleSet.prototype.getDomain=function(A){LABKEY.Domain.get(LABKEY.Utils.getOnSuccess(A),LABKEY.Utils.getOnFailure(A),"Samples",this.name,A.containerPath)};LABKEY.Exp.SampleSet.create=function(A){LABKEY.Domain.create(LABKEY.Utils.getOnSuccess(A),LABKEY.Utils.getOnFailure(A),"SampleSet",A.domainDesign,A.options,A.containerPath)};LABKEY.Exp.ChildObject=function(A){LABKEY.Exp.ExpObject.call(this,A);A=A||{}};LABKEY.Exp.ChildObject.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.ChildObject.prototype.constructor=LABKEY.Exp.ChildObject;LABKEY.Exp.ProtocolOutput=function(A){LABKEY.Exp.ExpObject.call(this,A);A=A||{};this.sourceProtocol=A.sourceProtocol;this.run=A.run;this.targetApplications=A.targetApplications;this.sourceApplications=A.sourceApplications;this.sucessorRuns=A.sucessorRuns;this.cpasType=A.cpasType};LABKEY.Exp.ProtocolOutput.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.ProtocolOutput.prototype.constructor=LABKEY.Exp.ProtocolOutput;LABKEY.Exp.Material=function(A){LABKEY.Exp.ProtocolOutput.call(this,A);A=A||{};this.sampleSet=A.sampleSet};LABKEY.Exp.Material.prototype=new LABKEY.Exp.ProtocolOutput;LABKEY.Exp.Material.prototype.constructor=LABKEY.Exp.Material;LABKEY.Exp.Data=function(A){LABKEY.Exp.ProtocolOutput.call(this,A);A=A||{};this.dataType=A.dataType;this.dataFileURL=A.dataFileURL;if(A.pipelinePath){this.pipelinePath=A.pipelinePath}if(A.role){this.role=A.role}};LABKEY.Exp.Data.prototype=new LABKEY.Exp.ProtocolOutput;LABKEY.Exp.Data.prototype.constructor=LABKEY.Exp.Data;LABKEY.Exp.Data.prototype.getContent=function(B){if(!LABKEY.Utils.getOnSuccess(B)){alert("You must specify a callback function in config.success when calling LABKEY.Exp.Data.getContent()!");return }function A(D,E,C){return function(F){var G=null;if(F&&F.getResponseHeader&&F.getResponseHeader("Content-Type")&&F.getResponseHeader("Content-Type").indexOf("application/json")>=0){G=LABKEY.ExtAdapter.decode(F.responseText)}else{G=F.responseText}if(D){D.call(C||this,G,E,F)}}}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("experiment","showFile"),method:"GET",params:{rowId:this.id,format:B.format},success:A(LABKEY.Utils.getOnSuccess(B),B.format,B.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(B),B.scope,true)})};LABKEY.QueryKey=function(B,A){if(B&&!(B instanceof B.constructor)){throw new Error("parent type not of same type as this")}this.parent=B;this.name=A};LABKEY.QueryKey.prototype.getName=function(){return this.name};LABKEY.QueryKey.prototype.equals=function(A){return A!=null&&this.constructor==A.constructor&&this.toString().toLowerCase()==A.toString().toLowerCase()};LABKEY.QueryKey.prototype.getParts=function(){var A=[];if(this.parent){A=this.parent.getParts()}A.push(this.name);return A};LABKEY.QueryKey.prototype.toString=function(B){var C=this.getParts();for(var A=0;A<C.length;A++){C[A]=LABKEY.QueryKey.encodePart(C[A])}return C.join(B)};LABKEY.QueryKey.prototype.toJSON=function(){return this.toString()};LABKEY.QueryKey.prototype.toDisplayString=function(){return this.getParts().join(".")};LABKEY.QueryKey.prototype.toSQLString=function(){var B=this.getParts();for(var A=0;A<B.length;A++){if(LABKEY.QueryKey.needsQuotes(B[A])){B[A]=LABKEY.QueryKey.quote(B[A])}}return B.join(".")};LABKEY.QueryKey.encodePart=function(A){return A.replace(/\$/g,"$D").replace(/\//g,"$S").replace(/\&/g,"$A").replace(/\}/g,"$B").replace(/\~/g,"$T").replace(/\,/g,"$C").replace(/\./g,"$P")};LABKEY.QueryKey.decodePart=function(A){return A.replace(/\$P/g,".").replace(/\$C/g,",").replace(/\$T/g,"~").replace(/\$B/g,"}").replace(/\$A/g,"&").replace(/\$S/g,"/").replace(/\$D/g,"$")};LABKEY.QueryKey.needsQuotes=function(A){if(!A.match(/^[a-zA-Z][_\$a-zA-Z0-9]*$/)){return true}if(A.match(/^(all|any|and|as|asc|avg|between|class|count|delete|desc|distinct|elements|escape|exists|false|fetch|from|full|group|having|in|indices|inner|insert|into|is|join|left|like|limit|max|min|new|not|null|or|order|outer|right|select|set|some|sum|true|union|update|user|versioned|where|case|end|else|then|when|on|both|empty|leading|member|of|trailing)$/i)){return true}return false};LABKEY.QueryKey.quote=function(A){return'"'+A.replace(/\"/g,'""')+'"'};LABKEY.SchemaKey=function(B,A){LABKEY.QueryKey.call(this,B,A)};LABKEY.SchemaKey.prototype=new LABKEY.QueryKey;LABKEY.SchemaKey.prototype.constructor=LABKEY.SchemaKey;LABKEY.SchemaKey.prototype.toString=function(){return LABKEY.QueryKey.prototype.toString.call(this,".")};LABKEY.SchemaKey.fromString=function(D){var C=D.split(".");var A=null;for(var B=0;B<C.length;B++){A=new LABKEY.SchemaKey(A,LABKEY.QueryKey.decodePart(C[B]))}return A};LABKEY.SchemaKey.fromParts=function(E){var C=null;for(var D=0;D<arguments.length;D++){var A=arguments[D];if(typeof A==="string"){C=new LABKEY.SchemaKey(C,A)}else{if(A&&A.length){for(var B=0;B<A.length;B++){C=new LABKEY.SchemaKey(C,A[B])}}else{throw"Illegal argument to fromParts: "+A}}}return C};LABKEY.FieldKey=function(B,A){LABKEY.QueryKey.call(this,B,A)};LABKEY.FieldKey.prototype=new LABKEY.QueryKey;LABKEY.FieldKey.prototype.constructor=LABKEY.FieldKey;LABKEY.FieldKey.prototype.toString=function(){return LABKEY.QueryKey.prototype.toString.call(this,"/")};LABKEY.FieldKey.fromString=function(D){var C=D.split("/");var A=null;for(var B=0;B<C.length;B++){A=new LABKEY.FieldKey(A,LABKEY.QueryKey.decodePart(C[B]))}return A};LABKEY.FieldKey.fromParts=function(){var C=null;for(var D=0;D<arguments.length;D++){var A=arguments[D];if(typeof A==="string"){C=new LABKEY.FieldKey(C,A)}else{if(A&&A.length){for(var B=0;B<A.length;B++){C=new LABKEY.FieldKey(C,A[B])}}else{throw"Illegal argument to fromParts: "+A}}}return C};LABKEY.Filter=new function(){function A(P,Q,O){var M=Q.split(";");var L="";var R="";for(var N=0;N<M.length;N++){var Q=LABKEY.ext.FormHelper.validate(P,M[N].trim(),O);if(Q==undefined){return undefined}L=L+R+Q;R=";"}return L}var K={};var J={eq:"neqornull",dateeq:"dateneq",dateneq:"dateeq",neqornull:"eq",neq:"eq",isblank:"isnonblank",isnonblank:"isblank",gt:"lte",dategt:"datelte",lt:"gte",datelt:"dategte",gte:"lt",dategte:"datelt",lte:"gt",datelte:"dategt",contains:"doesnotcontain",doesnotcontain:"contains",doesnotstartwith:"startswith",startswith:"doesnotstartwith","in":"notin",notin:"in",containsoneof:"containsnoneof",containsnoneof:"containsoneof",hasmvvalue:"nomvvalue",nomvvalue:"hasmvvalue"};var H={"in":"eq",containsoneof:"contains",containsnoneof:"doesnotcontain"};var E={eq:"in",neq:"notin",neqornull:"notin",doesnotcontain:"containsnoneof",contains:"containsoneof"};function D(P,O,N,M,Q){var L={getDisplayText:function(){return P},getLongDisplayText:function(){return Q||P},getURLSuffix:function(){return O},isDataValueRequired:function(){return N},isMultiValued:function(){return M},getOpposite:function(){return J[O]?K[J[O]]:null},getSingleValueFilter:function(){return this.isMultiValued()?K[H[O]]:this},getMultiValueFilter:function(){return this.isMultiValued()?null:K[E[O]]},validate:function(W,T,S){if(!N){return true}var V=C[T];var U=false;for(var R=0;!U&&R<V.length;R++){if(V[R].getURLSuffix()==O){U=true}}if(!U){alert("Filter type '"+P+"' can't be applied to "+T+" types.");return undefined}if(this.isMultiValued()){return A(T,W,S)}else{return LABKEY.ext.FormHelper.validate(T,W,S)}}};K[O]=L;return L}function I(L,N,M){return{getColumnName:function(){return L},getValue:function(){return N},getFilterType:function(){return M},getURLParameterName:function(O){return(O||"query")+"."+L+"~"+M.getURLSuffix()},getURLParameterValue:function(){return M.isDataValueRequired()?N:""}}}var G={Types:{HAS_ANY_VALUE:D("Has Any Value","",false,null),EQUAL:D("Equals","eq",true,null),DATE_EQUAL:D("Equals","dateeq",true,null),DATE_NOT_EQUAL:D("Does Not Equal","dateneq",true,null),NEQ_OR_NULL:D("Does Not Equal","neqornull",true,null),NOT_EQUAL_OR_MISSING:D("Does Not Equal","neqornull",true,null),NEQ:D("Does Not Equal","neq",true,null),NOT_EQUAL:D("Does Not Equal","neq",true,null),ISBLANK:D("Is Blank","isblank",false,null),MISSING:D("Is Blank","isblank",false,null),NONBLANK:D("Is Not Blank","isnonblank",false,null),NOT_MISSING:D("Is Not Blank","isnonblank",false,null),GT:D("Is Greater Than","gt",true,null),GREATER_THAN:D("Is Greater Than","gt",true,null),DATE_GREATER_THAN:D("Is Greater Than","dategt",true,null),LT:D("Is Less Than","lt",true,null),LESS_THAN:D("Is Less Than","lt",true,null),DATE_LESS_THAN:D("Is Less Than","datelt",true,null),GTE:D("Is Greater Than or Equal To","gte",true,null),GREATER_THAN_OR_EQUAL:D("Is Greater Than or Equal To","gte",true,null),DATE_GREATER_THAN_OR_EQUAL:D("Is Greater Than or Equal To","dategte",true,null),LTE:D("Is Less Than or Equal To","lte",true,null),LESS_THAN_OR_EQUAL:D("Is Less Than or Equal To","lte",true,null),DATE_LESS_THAN_OR_EQUAL:D("Is Less Than or Equal To","datelte",true,null),CONTAINS:D("Contains","contains",true,null),DOES_NOT_CONTAIN:D("Does Not Contain","doesnotcontain",true,null),DOES_NOT_START_WITH:D("Does Not Start With","doesnotstartwith",true,null),STARTS_WITH:D("Starts With","startswith",true,null),IN:D("Equals One Of","in",true,true,'Equals One Of (e.g. "a;b;c")'),EQUALS_ONE_OF:D("Equals One Of","in",true,true,'Equals One Of (e.g. "a;b;c")'),EQUALS_NONE_OF:D("Does Not Equal Any Of","notin",true,true,'Does Not Equal Any Of (e.g. "a;b;c")'),NOT_IN:D("Does Not Equal Any Of","notin",true,true,'Does Not Equal Any Of (e.g. "a;b;c")'),CONTAINS_ONE_OF:D("Contains One Of","containsoneof",true,true,'Contains One Of (e.g. "a;b;c")'),CONTAINS_NONE_OF:D("Does Not Contain Any Of","containsnoneof",true,true,'Does Not Contain Any Of (e.g. "a;b;c")'),HAS_MISSING_VALUE:D("Has a missing value indicator","hasmvvalue",false,null),DOES_NOT_HAVE_MISSING_VALUE:D("Does not have a missing value indicator","nomvvalue",false,null)},appendFilterParams:function(S,M,N){N=N||"query";S=S||{};if(M){for(var O=0;O<M.length;O++){var P=M[O];if(P.getFilterType().isDataValueRequired()&&null==P.getURLParameterValue()){continue}var Q=P.getURLParameterName(N);var R=P.getURLParameterValue();if(S[Q]!==undefined){var L=S[Q];if(!LABKEY.Utils.isArray(L)){L=[L]}L.push(R);R=L}S[Q]=R}}return S},appendAggregateParams:function(O,Q,N){N=N||"query";O=O||{};if(Q){for(var S=0;S<Q.length;++S){var L=Q[S];var R="type="+L.type;if(L.label){R=R+"&label="+L.label}if(L.type&&L.column){var P=N+".agg."+L.column;var M=encodeURIComponent(R);var U=O[P];if(O[P]!==undefined){var T=O[P];if(!LABKEY.Utils.isArray(T)){T=[T]}T.push(M);M=T}O[P]=M}}}return O},create:function(L,N,M){if(!M){M=this.Types.EQUAL}return I(L,N,M)},merge:function(Q,O,N){var M=[];if(null!=Q){for(var P=0;P<Q.length;P++){var L=Q[P];if(L.getColumnName()!=O){M.push(L)}}}return null==N?M:M.concat(N)},getFilterDescription:function(M,P,O){var Q=LABKEY.ActionURL.getParameters(M);var W="";var S="";for(var T in Q){if(T.indexOf(P+"."+O+"~")==0){var L=T.substring(T.indexOf("~")+1);var V=Q[T];if(!LABKEY.Utils.isArray(V)){V=[V]}var N=K[L];var U;if(!N){U=L}else{U=N.getDisplayText()}for(var R=0;R<V.length;R++){W+=S;S=" AND ";W+=U;W+=" ";W+=V[R]}}}return W},getFiltersFromUrl:function(M,O){O=O||"query";var P=LABKEY.ActionURL.getParameters(M);var S=[];for(var R in P){if(R.indexOf(O+".")==0){var T=R.indexOf("~");if(T!=-1){var N=R.substring(O.length+1,T);var Q=R.substring(T+1);var L=LABKEY.Filter.getFilterTypeForURLSuffix(Q);var U=P[R];if(!LABKEY.Utils.isArray(U)){U=[U]}S.push(LABKEY.Filter.create(N,U,L))}}}return S},getSortFromUrl:function(M,L){L=L||"query";var N=LABKEY.ActionURL.getParameters(M);return N[L+".sort"]},getFilterTypeForURLSuffix:function(L){return K[L]}};var F=G.Types;var C={"int":[F.HAS_ANY_VALUE,F.EQUAL,F.NEQ_OR_NULL,F.ISBLANK,F.NONBLANK,F.GT,F.LT,F.GTE,F.LTE,F.IN,F.NOT_IN],string:[F.HAS_ANY_VALUE,F.EQUAL,F.NEQ_OR_NULL,F.ISBLANK,F.NONBLANK,F.GT,F.LT,F.GTE,F.LTE,F.CONTAINS,F.DOES_NOT_CONTAIN,F.DOES_NOT_START_WITH,F.STARTS_WITH,F.IN,F.NOT_IN,F.CONTAINS_ONE_OF,F.CONTAINS_NONE_OF],"boolean":[F.HAS_ANY_VALUE,F.EQUAL,F.NEQ_OR_NULL,F.ISBLANK,F.NONBLANK],"float":[F.HAS_ANY_VALUE,F.EQUAL,F.NEQ_OR_NULL,F.ISBLANK,F.NONBLANK,F.GT,F.LT,F.GTE,F.LTE,F.IN,F.NOT_IN],date:[F.HAS_ANY_VALUE,F.DATE_EQUAL,F.DATE_NOT_EQUAL,F.ISBLANK,F.NONBLANK,F.DATE_GREATER_THAN,F.DATE_LESS_THAN,F.DATE_GREATER_THAN_OR_EQUAL,F.DATE_LESS_THAN_OR_EQUAL,F.IN,F.NOT_IN]};var B={"int":F.EQUAL,string:F.STARTS_WITH,"boolean":F.EQUAL,"float":F.EQUAL,date:F.DATE_EQUAL};G.getFilterTypesForType=function(N,L){var M=[];if(C[N]){M=M.concat(C[N])}if(L){M.push(F.HAS_MISSING_VALUE);M.push(F.DOES_NOT_HAVE_MISSING_VALUE)}return M};G.getDefaultFilterForType=function(L){if(B[L]){return B[L]}return F.EQUAL};return G};LABKEY.Form=function(C){if(!C.formElement){C={formElement:LABKEY.ExtAdapter.get(C)}}if(!C.formElement){throw"Invalid config passed to LABKEY.Form constructor! Your config object should have a property named formElement which is the id of your form."}this.formElement=LABKEY.ExtAdapter.get(C.formElement);this.warningMessage=C.warningMessage||"Your changes have not yet been saved. Choose Cancel to stay on the page and save your changes.";this._isDirty=false;var B=this.formElement.dom.elements;for(var A=0;A<B.length;++A){LABKEY.ExtAdapter.EventManager.on(B[A],"change",this.onElemChange,this)}LABKEY.ExtAdapter.EventManager.on(this.formElement,"submit",function(){this.setClean()},this);if(false!==C.showWarningMessage){if(!LABKEY.ExtAdapter.isIE&&!LABKEY.ExtAdapter.isGecko){window.onbeforeunload=function(){if(this.isDirty()){return this.warningMessage}}.createDelegate(this)}else{LABKEY.ExtAdapter.EventManager.on(window,"beforeunload",function(D){if(this.isDirty()){D.browserEvent.returnValue=this.warningMessage}},this)}}};LABKEY.Form.prototype.isDirty=function(){return this._isDirty};LABKEY.Form.prototype.setClean=function(){this._isDirty=false};LABKEY.Form.prototype.setDirty=function(){this._isDirty=true};LABKEY.Form.prototype.onElemChange=function(){this._isDirty=true};LABKEY.Message=new function(){return{recipientType:{to:"TO",cc:"CC",bcc:"BCC"},msgType:{plain:"text/plain",html:"text/html"},sendMessage:function(A){var B={};if(A.msgFrom!=undefined){B.msgFrom=A.msgFrom}if(A.msgRecipients!=undefined){B.msgRecipients=A.msgRecipients}if(A.msgContent!=undefined){B.msgContent=A.msgContent}if(A.msgSubject!=undefined){B.msgSubject=A.msgSubject}if(A.allowUnregisteredUser!=undefined){B.allowUnregisteredUser=A.allowUnregisteredUser}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("announcements","sendMessage"),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true),jsonData:B,headers:{"Content-Type":"application/json"}})},createMsgContent:function(A,B){return{type:A,content:B}},createRecipient:function(B,A){return{type:B,address:A}},createPrincipalIdRecipient:function(A,B){return{type:A,principalId:B}}}};LABKEY.MultiRequest=function(C){C=C||{};var M=this;var J=false;var E=[];var D=[];var A;var K;if(LABKEY.Utils.isArray(C)){A=C}else{A=C.requests;K=C.listeners}if(A){for(var G=0;G<A.length;G++){var F=A[G];this.add(F[0],F[1])}}var B=[];if(K&&K.done){if(typeof K.done=="function"){B.push({fn:K.done,scope:K.scope})}else{if(typeof K.done.fn=="function"){B.push({fn:K.done.fn,scope:K.done.scope||K.scope})}}}if(E.length&&B.length>0){this.send()}function I(){for(var O=0;O<B.length;O++){var N=B[O];if(N.fn&&typeof N.fn=="function"){N.fn.call(N.scope||window)}}}function L(){D.pop();if(D.length==0){J=false;I();M.send()}return true}function H(O,N,P){return function(){var Q=O.apply(P||this||window,arguments);N.apply(P||this||window,arguments);return Q}}this.add=function(Q,O,P){O=O||{};var R=LABKEY.Utils.getOnSuccess(O);if(!R){R=function(){}}if(!R._hookInstalled){O.success=H(R,L,O.scope);O.success._hookInstalled=true}var N=LABKEY.Utils.getOnFailure(O);if(!N){N=function(){}}if(!N._hookInstalled){O.failure=H(N,L,O.scope);O.failure._hookInstalled=true}E.push({fn:Q,args:[O],scope:P});return this};this.send=function(S,Q){if(J||E.length==0){return }J=true;D=E;E=new Array();var N=D.length;for(var P=0;P<N;P++){var R=D[P];R.fn.apply(R.scope||window,R.args)}var O=this;if(typeof S=="function"){B.push({fn:S,scope:Q})}else{if(typeof S.fn=="function"){B.push({fn:S.fn,scope:S.scope||Q})}}}};LABKEY.NavTrail=new function(){return{setTrail:function(E,G,D){var F=document.getElementById("labkey-nav-trail-current-page");if(F){F.innerHTML=E;F.style.visibility="visible"}F=document.getElementById("navTrailAncestors");if(F&&G){var C="";var B="";for(var A=0;A<G.length;++A){C+=B;if(G[A].url&&G[A].title){C+="<a href='"+G[A].url+"'>"+G[A].title+"</a>"}else{if(G[A].title){C+=G[A].title}}B=" &gt; "}F.innerHTML=C;F.visibility="visible"}document.title=(D||E)+": "+decodeURI(LABKEY.ActionURL.getContainer())}}};LABKEY.Pipeline=new function(){return{getPipelineContainer:function(A){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("pipeline","getPipelineContainer.api",A.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},getProtocols:function(C){var E=new Object();E.taskId=C.taskId;var A=C.containerPath?C.containerPath:LABKEY.ActionURL.getContainer();var B=LABKEY.ActionURL.buildURL("pipeline-analysis","getSavedProtocols.api",A);var D=LABKEY.Utils.getOnSuccess(C);LABKEY.Ajax.request({url:B,method:"POST",params:E,success:LABKEY.Utils.getCallbackWrapper(function(G,F){D.call(this,G.protocols,G.defaultProtocolName,F)},C.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(C),C.scope,true)})},getFileStatus:function(C){var E=new Object();E.taskId=C.taskId;E.path=C.path;E.file=C.files;E.protocolName=C.protocolName;var A=C.containerPath?C.containerPath:LABKEY.ActionURL.getContainer();var B=LABKEY.ActionURL.buildURL("pipeline-analysis","getFileStatus.api",A);var D=LABKEY.Utils.getOnSuccess(C);LABKEY.Ajax.request({url:B,method:"POST",timeout:60000000,params:E,success:LABKEY.Utils.getCallbackWrapper(function(G,F){D.call(this,G.files,G.submitType,F)},C.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(C),C.scope,true)})},startAnalysis:function(C){var D=new Object();D.taskId=C.taskId;D.path=C.path;if(!C.protocolName){throw"Invalid config, must include protocolName property"}D.protocolName=C.protocolName;D.protocolDescription=C.protocolDescription;D.file=C.files;D.fileIds=C.fileIds;D.saveProtocol=C.saveProtocol==undefined||C.saveProtocol;if(C.xmlParameters){D.configureXml=LABKEY.ExtAdapter.DomHelper.markup(C.xmlParameters)}else{if(C.jsonParameters){if(LABKEY.ExtAdapter.isString(C.jsonParameters)){D.configureJson=C.jsonParameters}else{D.configureJson=LABKEY.ExtAdapter.encode(C.jsonParameters)}}}var A=C.containerPath?C.containerPath:LABKEY.ActionURL.getContainer();var B=LABKEY.ActionURL.buildURL("pipeline-analysis","startAnalysis.api",A);LABKEY.Ajax.request({url:B,method:"POST",params:D,timeout:60000000,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(C),C.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(C),C.scope,true)})}}};LABKEY.Portal=new function(){var M="move";var C="remove";var O=0;var D=1;var J=0;var H=1;function I(R,P,S,Q){return function(V,T,U){A(V,P,S,Q);LABKEY.ExtAdapter.Msg.hide();if(R){R(V,T,U)}}}function A(Q,h,i,l){var R={};for(var T in Q){var Z=Q[T];for(var P=0;P<Z.length;P++){var k="webpart_"+Z[P].webPartId;R[k]=true}}var a=document.getElementsByTagName("table");var e=[];var b;var g;for(var c=0;c<a.length;c++){var j=a[c];var d=((h==C&&j.getAttribute("name")=="webpart")||R[j.id]);if(d){e[e.length]=j;if(j.id=="webpart_"+i){g=e.length-1;b=j}}}if(b){if(h==M){var Y=e[l==O?g-1:g+1];if(Y){var U=b.parentNode;var X=Y.nextSibling;var S=b.nextSibling;for(var f=0;f<U.childNodes.length;f++){if(U.childNodes[f]===Y){U.removeChild(b);U.removeChild(Y);U.insertBefore(b,X);U.insertBefore(Y,S);break}}}}else{if(h==C){var W=b.previousElementSibling;var V=b.previousSibling;b.parentNode.removeChild(W||V);b.parentNode.removeChild(b)}}}L(Q)}function F(S,Q){var P=S.parentNode;var R=P.parentNode;S.src=Q;R.replaceChild(S,P);R.className="labkey-wp-icon-button-inactive"}function G(S,P,Q){var R=document.createElement("a");R.href=P;S.src=Q;S.parentNode.className="labkey-wp-icon-button-active";S.parentNode.replaceChild(R,S);R.appendChild(S)}function L(P){var g=LABKEY.ActionURL.getContextPath()+"/_images/partup.png";var S=LABKEY.ActionURL.getContextPath()+"/_images/partupg.png";var Q=LABKEY.ActionURL.getContextPath()+"/_images/partdown.png";var d=LABKEY.ActionURL.getContextPath()+"/_images/partdowng.png";for(var U in P){var Z=P[U];var T=[];var h=[];var W;for(W=0;W<Z.length;W++){var e=Z[W];var f=document.getElementById("webpart_"+e.webPartId);if(f){T[T.length]=e;h[h.length]=f}}for(W=0;W<h.length;W++){var V=h[W];var X=T[W];var b=W==0;var a=W==T.length-1;var c=V.getElementsByTagName("img");for(var R=0;R<c.length;R++){var Y=c[R];if(Y.src.indexOf(g)>=0&&b){F(Y,S)}else{if(Y.src.indexOf(S)>=0&&!b){G(Y,"javascript:LABKEY.Portal.moveWebPartUp({webPartId:"+X.webPartId+",updateDOM:true});",g)}else{if(Y.src.indexOf(Q)>=0&&a){F(Y,d)}else{if(Y.src.indexOf(d)>=0&&!a){G(Y,"javascript:LABKEY.Portal.moveWebPartDown({webPartId:"+X.webPartId+",updateDOM:true});",Q)}}}}}}}}function K(P){return function(S,Q,R){LABKEY.ExtAdapter.Msg.hide();return P(S,Q,R)}}function B(){LABKEY.ExtAdapter.Msg.wait("Saving...")}function N(R,P,Q){LABKEY.Utils.displayAjaxErrorResponse(P,R)}function E(R,S,T){var U={};LABKEY.Utils.applyTranslated(U,R,{success:false,failure:false,scope:false});if(T==O||T==D){U.direction=T}var Q=LABKEY.Utils.getOnFailure(R)||N;if(R.updateDOM){Q=K(Q)}Q=LABKEY.Utils.getCallbackWrapper(Q,R.scope,true);var P=R.success;if(R.updateDOM){P=I(LABKEY.Utils.getOnSuccess(R),S,R.webPartId,T)}P=LABKEY.Utils.getCallbackWrapper(P,R.scope);return{params:U,success:P,error:Q}}return{getWebParts:function(P){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("project","getWebParts",P.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(P),P.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(P),P.scope,true),params:P})},moveWebPartUp:function(P){if(P.updateDOM){B()}var Q=E(P,M,O);LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("project","moveWebPartAsync",P.containerPath),method:"GET",success:LABKEY.Utils.getOnSuccess(Q),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(Q),Q.scope,true),params:Q.params})},moveWebPartDown:function(P){if(P.updateDOM){B()}var Q=E(P,M,D);LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("project","moveWebPartAsync",P.containerPath),method:"GET",success:LABKEY.Utils.getOnSuccess(Q),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(Q),Q.scope,true),params:Q.params})},removeWebPart:function(P){if(P.updateDOM){B()}var Q=E(P,C,undefined);LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("project","deleteWebPartAsync",P.containerPath),method:"GET",success:LABKEY.Utils.getOnSuccess(Q),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(Q),Q.scope,true),params:Q.params})},moveTabLeft:function(P){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("admin","moveTab",LABKEY.container.path),method:"GET",success:LABKEY.Utils.getCallbackWrapper(function(Q,R){if(P.folderLabel&&Q.pageIdToSwap&&Q.pageIdToSwap!==Q.pageId){var T=LABKEY.ExtAdapter.query(".labkey-app-bar ul li");for(var S=0;S<T.length;S++){var W=LABKEY.ExtAdapter.get(T[S]);var V=W.query("a");var U=V[0].text||V[0].innerText;if(U===P.folderLabel){if(T[S-1]){W.insertBefore(T[S-1])}}}}},this,false),failure:function(Q){},params:{pageId:P.pageId,direction:J}})},moveTabRight:function(P){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("admin","moveTab",LABKEY.container.path),method:"GET",success:LABKEY.Utils.getCallbackWrapper(function(Q,R){if(P.folderLabel&&Q.pageIdToSwap&&Q.pageIdToSwap!==Q.pageId){var T=LABKEY.ExtAdapter.query(".labkey-app-bar ul li");for(var S=0;S<T.length;S++){var W=LABKEY.ExtAdapter.get(T[S]);var V=W.query("a");var U=V[0].text||V[0].innerText;if(U===P.folderLabel){if(T[S+1]&&T[S+1].getAttribute("id")!=="addTab"){W.insertAfter(T[S+1])}}}}},this,false),failure:function(Q,R){},params:{pageId:P.pageId,direction:H}})}}};LABKEY.Query=new function(){function D(G){var H={schemaName:G.schemaName,queryName:G.queryName,rows:G.rows||G.rowDataArray,transacted:G.transacted,extraContext:G.extraContext};var F={url:LABKEY.ActionURL.buildURL("query",G.action,G.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(G),G.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(G),G.scope,true),jsonData:H,headers:{"Content-Type":"application/json"}};if(LABKEY.ExtAdapter.isDefined(G.timeout)){F.timeout=G.timeout}return LABKEY.Ajax.request(F)}function B(F){return F&&F.getResponseHeader?F.getResponseHeader("Content-Type"):null}function C(F,I,G,H){if(H&&(H===13.2||H==="13.2")){return LABKEY.Utils.getCallbackWrapper(function(L,J,K){if(L&&F){F.call(G||this,new LABKEY.Query.Response(L),J,K)}},this)}return LABKEY.Utils.getCallbackWrapper(function(L,J,K){if(L&&L.rows&&I){A(L)}if(F){F.call(G||this,L,K,J)}},this)}function A(J){var M=[];var L=[];var H=[];var G=J.columnModel;for(var F=0;F<G.length;++F){if(G[F].hidden){M.push(G[F].dataIndex)}else{L.push(G[F]);H.push(J.metaData.fields[F])}}J.columnModel=L;J.metaData.fields=H;var K;for(F=0;F<J.rows.length;++F){K=J.rows[F];for(var I=0;I<M.length;++I){delete K[M[I]];delete K[LABKEY.Query.URL_COLUMN_PREFIX+M[I]]}}}function E(F){return{schemaName:F[0],queryName:F[1],rows:F[2],successCallback:F[3],errorCallback:F[4]}}return{containerFilter:{current:"Current",currentAndFirstChildren:"CurrentAndFirstChildren",currentAndSubfolders:"CurrentAndSubfolders",currentPlusProject:"CurrentPlusProject",currentAndParents:"CurrentAndParents",currentPlusProjectAndShared:"CurrentPlusProjectAndShared",allFolders:"AllFolders"},executeSql:function(G){var I={schemaName:G.schemaName,sql:G.sql};if(G.saveInSession!==undefined&&G.saveInSession!==null){I.saveInSession=G.saveInSession}if(G.maxRows&&G.maxRows>=0){I.maxRows=G.maxRows}if(G.offset&&G.offset>0){I.offset=G.offset}if(G.includeTotalCount!=undefined){I.includeTotalCount=G.includeTotalCount}if(G.containerFilter){I.containerFilter=G.containerFilter}if(G.requiredVersion){I.apiVersion=G.requiredVersion}var H;if(G.sort){H={"query.sort":G.sort}}if(G.parameters){for(var J in G.parameters){H["query.param."+J]=G.parameters[J]}}var F={url:LABKEY.ActionURL.buildURL("query","executeSql",G.containerPath,H),method:"POST",success:C(LABKEY.Utils.getOnSuccess(G),G.stripHiddenColumns,G.scope,G.requiredVersion),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(G),G.scope,true),jsonData:I,headers:{"Content-Type":"application/json"}};if(LABKEY.ExtAdapter.isDefined(G.timeout)){F.timeout=G.timeout}return LABKEY.Ajax.request(F)},exportSql:function(F){var H='<form method="POST" action="'+LABKEY.ActionURL.buildURL("query","exportSql",F.containerPath)+'">';if(undefined!=F.sql){H+='<input type="hidden" name="sql" value="'+LABKEY.ExtAdapter.htmlEncode(F.sql)+'" />'}if(undefined!=F.schemaName){H+='<input type="hidden" name="schemaName" value="'+LABKEY.ExtAdapter.htmlEncode(F.schemaName)+'" />'}if(undefined!=F.format){H+='<input type="hidden" name="format" value="'+LABKEY.ExtAdapter.htmlEncode(F.format)+'" />'}if(undefined!=F.containerFilter){H+='<input type="hidden" name="containerFilter" value="'+LABKEY.ExtAdapter.htmlEncode(F.containerFilter)+'" />'}H+="</form>";var G=LABKEY.ExtAdapter.DomHelper.append(document.getElementsByTagName("body")[0],H);G.submit()},selectRows:function(G){var J="GET";if(arguments.length>1){G={schemaName:arguments[0],queryName:arguments[1],success:arguments[2],errorCallback:arguments[3],filterArray:arguments[4],sort:arguments[5],viewName:arguments[6]}}if(!G.schemaName){throw"You must specify a schemaName!"}if(!G.queryName){throw"You must specify a queryName!"}G.dataRegionName=G.dataRegionName||"query";var H=LABKEY.Query.buildQueryParams(G.schemaName,G.queryName,G.filterArray,G.sort,G.dataRegionName);if(!G.showRows||G.showRows=="paginated"){if(G.offset){H[G.dataRegionName+".offset"]=G.offset}if(G.maxRows!=undefined){if(G.maxRows<0){H[G.dataRegionName+".showRows"]="all"}else{H[G.dataRegionName+".maxRows"]=G.maxRows}}}else{if(G.showRows in {all:true,selected:true,unselected:true,none:true}){H[G.dataRegionName+".showRows"]=G.showRows}}if(G.viewName){H[G.dataRegionName+".viewName"]=G.viewName}if(G.columns){H[G.dataRegionName+".columns"]=LABKEY.ExtAdapter.isArray(G.columns)?G.columns.join(","):G.columns}if(G.selectionKey){H[G.dataRegionName+".selectionKey"]=G.selectionKey}if(G.parameters){for(var I in G.parameters){H[G.dataRegionName+".param."+I]=G.parameters[I]}}if(G.requiredVersion){H.apiVersion=G.requiredVersion}if(G.containerFilter){H.containerFilter=G.containerFilter}if(G.includeTotalCount){H.includeTotalCount=G.includeTotalCount}if(G.includeDetailsColumn){H.includeDetailsColumn=G.includeDetailsColumn}if(G.includeUpdateColumn){H.includeUpdateColumn=G.includeUpdateColumn}if(G.includeStyle){H.includeStyle=G.includeStyle}if(G.method&&(G.method.toUpperCase()==="GET"||G.method.toUpperCase()==="POST")){J=G.method.toUpperCase()}var F={url:LABKEY.ActionURL.buildURL("query","getQuery",G.containerPath),method:J,success:C(LABKEY.Utils.getOnSuccess(G),G.stripHiddenColumns,G.scope,G.requiredVersion),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(G),G.scope,true),params:H};if(LABKEY.ExtAdapter.isDefined(G.timeout)){F.timeout=G.timeout}return LABKEY.Ajax.request(F)},selectDistinctRows:function(F){if(!F.schemaName){throw"You must specify a schemaName!"}if(!F.queryName){throw"You must specify a queryName!"}if(!F.column){throw"You must specify a column!"}var G=LABKEY.Query.buildQueryParams(F.schemaName,F.queryName,F.filterArray);G["query.columns"]=F.column;if(F.viewName){G["query.viewName"]=F.viewName}if(F.maxRows&&F.maxRows>=0){G.maxRows=F.maxRows}if(F.containerFilter){G.containerFilter=F.containerFilter}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","selectDistinct",F.containerPath),method:"GET",success:C(LABKEY.Utils.getOnSuccess(F),false,F.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(F),F.scope,true),params:G})},getDataViews:function(F){var G={includeData:true,includeMetadata:false};if(F.dataTypes){G.dataTypes=F.dataTypes}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("study","browseData",F.containerPath),method:"POST",success:C(LABKEY.Utils.getOnSuccess(F),false,F.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(F),F.scope,true),jsonData:G,headers:{"Content-Type":"application/json"}})},updateRows:function(F){if(arguments.length>1){F=E(arguments)}F.action="updateRows";return D(F)},saveRows:function(G){if(arguments.length>1){G=E(arguments)}var H={commands:G.commands,containerPath:G.containerPath,transacted:G.transacted,extraContext:G.extraContext};var F={url:LABKEY.ActionURL.buildURL("query","saveRows",G.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(G),G.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(G),G.scope,true),jsonData:H,headers:{"Content-Type":"application/json"}};if(LABKEY.ExtAdapter.isDefined(G.timeout)){F.timeout=G.timeout}return LABKEY.Ajax.request(F)},insertRows:function(F){if(arguments.length>1){F=E(arguments)}F.action="insertRows";return D(F)},deleteRows:function(F){if(arguments.length>1){F=E(arguments)}F.action="deleteRows";return D(F)},buildQueryParams:function(K,J,F,H,G){G=G||"query";var I={};I.dataRegionName=G;I[G+".queryName"]=J;I.schemaName=K;if(H){I[G+".sort"]=H}LABKEY.Filter.appendFilterParams(I,F,G);return I},getAggregatesForType:function(F){F=F.toLowerCase();var G=[LABKEY.AggregateTypes.COUNT];switch(F){case"boolean":case"int":case"float":case"date":G.push(LABKEY.AggregateTypes.SUM);G.push(LABKEY.AggregateTypes.AVG);G.push(LABKEY.AggregateTypes.MIN);G.push(LABKEY.AggregateTypes.MAX);break;case"string":break}return G},getSchemas:function(F){var G={};if(F.apiVersion){G.apiVersion=F.apiVersion}if(F.schemaName){G.schemaName=F.schemaName}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","getSchemas",F.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(F),F.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(F),F.scope,true),params:G})},getQueries:function(F){var G={};LABKEY.Utils.applyTranslated(G,F,{schemaName:"schemaName",includeColumns:"includeColumns",includeUserQueries:"includeUserQueries",includeSystemQueries:"includeSystemQueries"},false,false);return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","getQueries",F.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(F),F.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(F),F.scope,true),params:G})},getQueryViews:function(F){var G={};if(F.schemaName){G.schemaName=F.schemaName}if(F.queryName){G.queryName=F.queryName}if(F.viewName!=undefined){G.viewName=F.viewName}if(F.metadata){G.metadata=F.metadata}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","getQueryViews",F.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(F),F.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(F),F.scope,true),params:G})},saveQueryViews:function(F){var G={};if(F.schemaName){G.schemaName=F.schemaName}if(F.queryName){G.queryName=F.queryName}if(F.views){G.views=F.views}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","saveQueryViews",F.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(F),F.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(F),F.scope,true),jsonData:G,headers:{"Content-Type":"application/json"}})},getQueryDetails:function(F){var G={};if(F.schemaName){G.schemaName=F.schemaName}if(F.queryName){G.queryName=F.queryName}if(F.viewName!=undefined){G.viewName=F.viewName}if(F.fields){G.fields=F.fields}if(F.fk){G.fk=F.fk}if(F.initializeMissingView){G.initializeMissingView=F.initializeMissingView}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","getQueryDetails",F.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(F),F.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(F),F.scope,true),params:G})},validateQuery:function(F){var G={};LABKEY.Utils.applyTranslated(G,F,{successCallback:false,errorCallback:false,scope:false});return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query",(F.validateQueryMetadata?"validateQueryMetadata":"validateQuery"),F.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(F),F.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(F),F.scope,true),params:G})},getServerDate:function(F){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","getServerDate"),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(F),F.scope),success:LABKEY.Utils.getCallbackWrapper(function(G){var I;var H=LABKEY.Utils.getOnSuccess(F);if(G&&G.date&&H){I=new Date(G.date);H(I)}},this)})},sqlDateTimeLiteral:function(H,I){if(H===undefined||H===null||!H){return"NULL"}if(typeof H=="string"){try{H=new Date(H)}catch(G){}}if(typeof H=="object"&&typeof H.toISOString=="function"){var F=function(K){return(K>=10?""+K:"0"+K)};var J=function(K){return(K>=100?""+K:"0"+F(K))};return"{ts '"+H.getFullYear()+"-"+F(H.getMonth()+1)+"-"+F(H.getDate())+" "+F(H.getHours())+":"+F(H.getMinutes())+":"+F(H.getSeconds())+(I?"."+J(H.getMilliseconds()):"")+"'}"}return"{ts '"+this.sqlStringLiteral(H)+"'}"},sqlDateLiteral:function(H){if(H===undefined||H===null||!H){return"NULL"}if(typeof H=="string"){try{H=new Date(H)}catch(G){}}if(typeof H=="object"&&typeof H.toISOString=="function"){var F=function(J){return(J>=10?J:"0"+J)};var I=function(J){return(J>=999?J:"0"+F(J))};return"{d '"+H.getFullYear()+"-"+F(H.getMonth()+1)+"-"+F(H.getDate())+"'}"}return"{d '"+this.sqlStringLiteral(H)+"'}"},sqlStringLiteral:function(F){if(F===undefined||F===null||F==""){return"NULL"}F=F.toString();return"'"+F.replace("'","''")+"'"},URL_COLUMN_PREFIX:"_labkeyurl_"}};LABKEY.Query.Filter=function(A,C,B){if(A){if(A instanceof LABKEY.FieldKey){A=A.toString()}else{if(A instanceof Array){A=A.join("/")}}}if(!B){B=LABKEY.Filter.Types.EQUAL}this.columnName=A;this.value=C;this.filterType=B};LABKEY.Query.Filter.prototype.getColumnName=function(){return this.columnName};LABKEY.Query.Filter.prototype.getFilterType=function(){return this.filterType};LABKEY.Query.Filter.prototype.getValue=function(){return this.value};LABKEY.Query.Filter.prototype.getURLParameterValue=function(){return this.filterType.isDataValueRequired()?this.value:""};LABKEY.Query.Filter.prototype.getURLParameterName=function(A){return(A||"query")+"."+this.columnName+"~"+this.filterType.getURLSuffix()};LABKEY.Query.Filter.HasAnyValue=function(A){LABKEY.Query.Filter.call(this,A,null,LABKEY.Filter.Types.HAS_ANY_VALUE)};LABKEY.Query.Filter.HasAnyValue.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Equal=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.EQUAL)};LABKEY.Query.Filter.Equal.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DateEqual=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.DATE_EQUAL)};LABKEY.Query.Filter.DateEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DateNotEqual=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.DATE_NOT_EQUAL)};LABKEY.Query.Filter.DateNotEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NotEqualOrNull=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.NEQ_OR_NULL)};LABKEY.Query.Filter.NotEqualOrNull.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NotEqualOrMissing=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.NOT_EQUAL_OR_MISSING)};LABKEY.Query.Filter.NotEqualOrMissing.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NotEqual=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.NOT_EQUAL)};LABKEY.Query.Filter.NotEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Neq=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.NEQ)};LABKEY.Query.Filter.Neq.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.IsBlank=function(A){LABKEY.Query.Filter.call(this,A,null,LABKEY.Filter.Types.ISBLANK)};LABKEY.Query.Filter.IsBlank.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Missing=function(A){LABKEY.Query.Filter.call(this,A,null,LABKEY.Filter.Types.MISSING)};LABKEY.Query.Filter.Missing.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NonBlank=function(A){LABKEY.Query.Filter.call(this,A,null,LABKEY.Filter.Types.NONBLANK)};LABKEY.Query.Filter.NonBlank.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NotMissing=function(A){LABKEY.Query.Filter.call(this,A,null,LABKEY.Filter.Types.NOT_MISSING)};LABKEY.Query.Filter.NotMissing.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Gt=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.GT)};LABKEY.Query.Filter.Gt.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.GreaterThan=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.GREATER_THAN)};LABKEY.Query.Filter.GreaterThan.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Lt=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.LT)};LABKEY.Query.Filter.Lt.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.LessThan=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.LESS_THAN)};LABKEY.Query.Filter.LessThan.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DateLessThan=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.DATE_LESS_THAN)};LABKEY.Query.Filter.DateLessThan.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Gte=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.GTE)};LABKEY.Query.Filter.Gte.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.GreaterThanOrEqual=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.GREATER_THAN_OR_EQUAL)};LABKEY.Query.Filter.GreaterThanOrEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DateGreaterThanOrEqual=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.DATE_GREATER_THAN_OR_EQUAL)};LABKEY.Query.Filter.DateGreaterThanOrEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Lte=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.LTE)};LABKEY.Query.Filter.Lte.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.LessThanOrEqual=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.LESS_THAN_OR_EQUAL)};LABKEY.Query.Filter.LessThanOrEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DateLessThanOrEqual=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.DATE_LESS_THAN_OR_EQUAL)};LABKEY.Query.Filter.DateLessThanOrEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Contains=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.CONTAINS)};LABKEY.Query.Filter.Contains.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DoesNotContain=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.DOES_NOT_CONTAIN)};LABKEY.Query.Filter.DoesNotContain.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.StartsWith=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.STARTS_WITH)};LABKEY.Query.Filter.StartsWith.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.In=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.IN)};LABKEY.Query.Filter.In.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.EqualsOneOf=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.EQUALS_ONE_OF)};LABKEY.Query.Filter.EqualsOneOf.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.EqualsNoneOf=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.EQUALS_NONE_OF)};LABKEY.Query.Filter.EqualsNoneOf.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NotIn=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.NOT_IN)};LABKEY.Query.Filter.NotIn.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.ContainsOneOf=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.CONTAINS_ONE_OF)};LABKEY.Query.Filter.ContainsOneOf.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.ContainsNoneOf=function(A,B){LABKEY.Query.Filter.call(this,A,B,LABKEY.Filter.Types.CONTAINS_NONE_OF)};LABKEY.Query.Filter.ContainsNoneOf.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.HasMissingValue=function(A){LABKEY.Query.Filter.call(this,A,null,LABKEY.Filter.Types.HAS_MISSING_VALUE)};LABKEY.Query.Filter.HasMissingValue.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DoesNotHaveMissingValue=function(A){LABKEY.Query.Filter.call(this,A,null,LABKEY.Filter.Types.DOES_NOT_HAVE_MISSING_VALUE)};LABKEY.Query.Filter.DoesNotHaveMissingValue.prototype=new LABKEY.Query.Filter;(function(){LABKEY.Query.Row=function(row){this.links=null;if(row.links){this.links=row.links}for(var attr in row.data){if(row.data.hasOwnProperty(attr)){this[attr]=row.data[attr]}}};LABKEY.Query.Row.prototype.get=function(columnName){columnName=columnName.toLowerCase();for(var attr in this){if(attr.toLowerCase()===columnName&&this.hasOwnProperty(attr)&&!(this[attr] instanceof Function)){return this[attr]}}return null};LABKEY.Query.Row.prototype.getValue=function(columnName){columnName=columnName.toLowerCase();for(var attr in this){if(attr.toLowerCase()===columnName&&this.hasOwnProperty(attr)&&!(this[attr] instanceof Function)){if(this[attr].value){return this[attr].value}}}return null};LABKEY.Query.Row.prototype.getLinks=function(){return this.links};LABKEY.Query.Row.prototype.getLink=function(linkType){if(this.links[linkType]){return this.links[linkType]}return null};var generateColumnModel=function(fields){var i,columns=[];for(i=0;i<fields.length;i++){columns.push({scale:fields[i].scale,hidden:fields[i].hidden,sortable:fields[i].sortable,align:fields[i].align,width:fields[i].width,dataIndex:fields[i].fieldKey.toString(),required:fields[i].nullable,editable:fields[i].userEditable,header:fields[i].shortCaption})}return columns};var generateGetDisplayField=function(fieldKeyToFind,fields){return function(){var fieldString=fieldKeyToFind.toString();for(var i=0;i<fields.length;i++){if(fieldString==fields[i].fieldKey.toString()){return fields[i]}}return null}};LABKEY.Query.Response=function(response){var i,attr;for(attr in response){if(response.hasOwnProperty(attr)){this[attr]=response[attr]}}this.schemaKey=LABKEY.SchemaKey.fromParts(response.schemaName);for(i=0;i<response.metaData.fields.length;i++){var field=response.metaData.fields[i],lookup=field.lookup;field.fieldKey=LABKEY.FieldKey.fromParts(field.fieldKey);if(lookup&&lookup.schemaName){lookup.schemaName=LABKEY.SchemaKey.fromParts(lookup.schemaName)}if(field.displayField){field.displayField=LABKEY.FieldKey.fromParts(field.displayField);field.getDisplayField=generateGetDisplayField(field.displayField,response.metaData.fields)}if(field.extFormatFn){field.extFormatFn=eval(field.extFormatFn)}}this.columnModel=generateColumnModel(this.metaData.fields);for(i=0;i<this.rows.length;i++){this.rows[i]=new LABKEY.Query.Row(this.rows[i])}return this};LABKEY.Query.Response.prototype.getMetaData=function(){return this.metaData};LABKEY.Query.Response.prototype.getSchemaName=function(asString){return asString?this.schemaKey.toString():this.schemaName};LABKEY.Query.Response.prototype.getQueryName=function(){return this.queryName};LABKEY.Query.Response.prototype.getColumnModel=function(){return this.columnModel};LABKEY.Query.Response.prototype.getRows=function(){return this.rows};LABKEY.Query.Response.prototype.getRow=function(idx){if(this.rows[idx]!==undefined){return this.rows[idx]}throw new Error("No row found for index "+idx)};LABKEY.Query.Response.prototype.getRowCount=function(){return this.rowCount}})();LABKEY.Report=new function(){function A(B,C){return LABKEY.Utils.getCallbackWrapper(function(G,E,F){if(G&&G.outputParams){for(var D=0;D<G.outputParams.length;D++){var H=G.outputParams[D];if(H.type=="json"){H.value=LABKEY.ExtAdapter.decode(H.value)}}}if(B){B.call(C||this,G,F,E)}},this)}return{createSession:function(C){var B=C&&C.containerPath;var D={};D.clientContext=C.clientContext;LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("reports","createSession",B),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(C),C.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(C),C.scope,true),jsonData:D})},deleteSession:function(B){var C={reportSessionId:B.reportSessionId};LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("reports","deleteSession",B.containerPath),method:"POST",params:C,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(B),B.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(B),B.scope,true)})},getSessions:function(B){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("reports","getSessions",B.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(B),B.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(B),B.scope,true)})},execute:function(B){if(!B){throw"You must supply a config object to call this method."}if(!B.reportId){throw"You must supply a value for the reportId config property."}var D={};for(var C in B.inputParams){D["inputParams["+C+"]"]=B.inputParams[C]}D.reportId=B.reportId;if(B.reportSessionId){D.reportSessionId=B.reportSessionId}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("reports","execute",B.containerPath),method:"POST",success:A(LABKEY.Utils.getOnSuccess(B),B.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(B),B.scope,true),jsonData:D})}}};LABKEY.Security=new function(){return{permissions:{read:1,insert:2,update:4,del:8,readOwn:16,updateOwn:64,deleteOwn:128,admin:32768,all:65535},effectivePermissions:{insert:"org.labkey.api.security.permissions.InsertPermission",read:"org.labkey.api.security.permissions.ReadPermission",admin:"org.labkey.api.security.permissions.AdminPermission",del:"org.labkey.api.security.permissions.DeletePermission",readOwn:"org.labkey.api.security.permissions.ReadSomePermission",update:"org.labkey.api.security.permissions.UpdatePermission"},roles:{admin:65535,editor:15,author:195,reader:1,restrictedReader:16,submitter:2,noPerms:0},systemGroups:{administrators:-1,users:-2,guests:-3,developers:-4},getGroupPermissions:function(A){var B={};if(A.includeSubfolders!=undefined){B.includeSubfolders=A.includeSubfolders}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getGroupPerms",A.containerPath),method:"GET",params:B,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},hasPermission:function(A,B){return A&B},hasEffectivePermission:function(C,A){for(var B=0;B<C.length;B++){if(C[B]==A){return true}}return false},getRole:function(A){for(var B in LABKEY.Security.roles){if(A==LABKEY.Security.roles[B]){return B}}},getUserPermissions:function(A){var B={};if(A.userId!=undefined){B.userId=A.userId}else{if(A.userEmail!=undefined){B.userEmail=A.userEmail}}if(A.includeSubfolders!=undefined){B.includeSubfolders=A.includeSubfolders}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getUserPerms",A.containerPath),method:"GET",params:B,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},getUsers:function(A){var B={};if(undefined!=A.groupId){B.groupId=A.groupId}else{if(undefined!=A.group){B.group=A.group}}if(undefined!=A.name){B.name=A.name}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("user","getUsers",A.containerPath),method:"GET",params:B,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},createContainer:function(A){var B={};B.name=A.name;B.title=A.title;B.description=A.description;B.isWorkbook=A.isWorkbook;B.folderType=A.folderType;return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("core","createContainer",A.containerPath),method:"POST",jsonData:B,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},deleteContainer:function(A){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("core","deleteContainer",A.containerPath),method:"POST",jsonData:{},success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},moveContainer:function(A){var B={};B.container=A.container||A.containerPath;B.parent=A.destinationParent||A.parent||A.parentPath;B.addAlias=true;if(!B.container){console.error("'containerPath' must be specified for LABKEY.Security.moveContainer invocation.");return }if(!B.parent){console.error("'parent' must be specified for LABKEY.Security.moveContainer invocation.");return }if(A.addAlias===false){B.addAlias=false}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("core","moveContainer",B.container),method:"POST",jsonData:B,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},getFolderTypes:function(A){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("core","getFolderTypes",A.containerPath),method:"POST",jsonData:{},success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},getModules:function(A){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("admin","getModules",A.containerPath),method:"POST",jsonData:{},success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},getContainers:function(A){var B={};A=A||{};if(undefined!=A.container){if(LABKEY.Utils.isArray(A.container)){B.multipleContainers=true}else{A.container=[A.container]}B.container=A.container}if(undefined!=A.includeSubfolders){B.includeSubfolders=A.includeSubfolders}if(undefined!=A.depth){B.depth=A.depth}if(undefined!=A.moduleProperties){B.moduleProperties=A.moduleProperties}if(undefined!=A.includeEffectivePermissions){B.includeEffectivePermissions=A.includeEffectivePermissions}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("project","getContainers",A.containerPath),method:"GET",params:B,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},currentUser:LABKEY.user,currentContainer:LABKEY.container,getGroupsForCurrentUser:function(A){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getGroupsForCurrentUser",A.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},ensureLogin:function(A){if(LABKEY.Security.currentUser.isGuest||A.force){if(A.useSiteLoginPage){window.location=LABKEY.ActionURL.buildURL("login","login")+"?returnUrl="+window.location}else{return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","ensureLogin"),method:"GET",success:LABKEY.Utils.getCallbackWrapper(function(C,B){if(C.currentUser){LABKEY.Security.currentUser=C.currentUser}if(LABKEY.Utils.getOnSuccess(A)){LABKEY.Utils.getOnSuccess(A).call(A.scope||this,C,B)}},this),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})}}else{LABKEY.Utils.getOnSuccess(A).call(A.scope||this,{currentUser:LABKEY.Security.currentUser})}},getSecurableResources:function(A){var B={};if(undefined!=A.includeSubfolders){B.includeSubfolders=A.includeSubfolders}if(undefined!=A.includeEffectivePermissions){B.includeEffectivePermissions=A.includeEffectivePermissions}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getSecurableResources",A.containerPath),method:"GET",params:B,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},getSchemaPermissions:function(B){if(B.schemaName&&B.schemaName!="study"){throw"Method only works for the study schema"}var A=function(I,F){var L=null;for(var H=0;H<I.resources.children.length;H++){var J=I.resources.children[H];if(J.resourceClass=="org.labkey.study.model.StudyImpl"){L=J;break}}if(null==L){B.failure.apply(B.scope||this,[{description:"No study found in container."},F]);return }var E={queries:{}},K;for(H=0;H<L.children.length;H++){K=L.children[H];E.queries[K.name]=K;K.permissionMap={};for(var G=0;G<K.effectivePermissions.length;G++){K.permissionMap[K.effectivePermissions[G]]=true}}B.success.apply(B.scope||this,[{schemas:{study:E}},F])};var C={};if(B){for(var D in B){if(B.hasOwnProperty(D)){C[D]=D}}}C.includeEffectivePermissions=true;C.success=A;return LABKEY.Security.getSecurableResources(C)},getRoles:function(A){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getRoles"),method:"GET",success:LABKEY.Utils.getCallbackWrapper(function(G,E){var B;var D={};var C;for(B=0;B<G.permissions.length;++B){C=G.permissions[B];D[C.uniqueName]=C}var F;var H;for(B=0;B<G.roles.length;++B){H=G.roles[B];for(F=0;F<H.permissions.length;++F){H.permissions[F]=D[H.permissions[F]]}}LABKEY.Utils.getOnSuccess(A).call(A.scope||this,G.roles,E)},this),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},getPolicy:function(A){var B={resourceId:A.resourceId};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getPolicy",A.containerPath),method:"GET",params:B,success:LABKEY.Utils.getCallbackWrapper(function(D,C){D.policy.requestedResourceId=A.resourceId;var E=new LABKEY.SecurityPolicy(D.policy);LABKEY.Utils.getOnSuccess(A).call(A.scope||this,E,D.relevantRoles,C)},this),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})},deletePolicy:function(A){var B={resourceId:A.resourceId};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","deletePolicy",A.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true),jsonData:B,headers:{"Content-Type":"application/json"}})},savePolicy:function(A){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","savePolicy",A.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true),jsonData:A.policy.policy,headers:{"Content-Type":"application/json"}})},createGroup:function(A){var B={name:A.groupName};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","createGroup",A.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true),jsonData:B,headers:{"Content-Type":"application/json"}})},deleteGroup:function(A){var B={id:A.groupId};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","deleteGroup",A.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true),jsonData:B,headers:{"Content-Type":"application/json"}})},renameGroup:function(A){var B={id:A.groupId,newName:A.newName};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","renameGroup",A.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true),jsonData:B,headers:{"Content-Type":"application/json"}})},addGroupMembers:function(A){var B={groupId:A.groupId,principalIds:(LABKEY.Utils.isArray(A.principalIds)?A.principalIds:[A.principalIds])};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","addGroupMember",A.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true),jsonData:B,headers:{"Content-Type":"application/json"}})},removeGroupMembers:function(A){var B={groupId:A.groupId,principalIds:(LABKEY.Utils.isArray(A.principalIds)?A.principalIds:[A.principalIds])};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","removeGroupMember",A.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true),jsonData:B,headers:{"Content-Type":"application/json"}})},createNewUser:function(A){var B={email:A.email,sendEmail:A.sendEmail};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","createNewUser",A.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true),jsonData:B,headers:{"Content-Type":"application/json"}})},getHomeContainer:function(){return LABKEY.homeContainer},getSharedContainer:function(){return LABKEY.sharedContainer}}};LABKEY.Specimen=new function(){function A(D,C){return LABKEY.Utils.getCallbackWrapper(function(E){D(C?E[C]:E)},this)}function B(C){LABKEY.Ajax.request({url:C.url,method:C.method||"POST",success:C.success,failure:C.failure,jsonData:C.jsonData,headers:{"Content-Type":"application/json"}})}return{getRepositories:function(C){if(C&&(LABKEY.Utils.isFunction(C)||arguments.length>1)){C={success:arguments[0],failure:arguments[1],containerPath:arguments[2]}}B({url:LABKEY.ActionURL.buildURL("study-samples-api","getRespositories",C.containerPath),success:A(C.success,"repositories"),failure:LABKEY.Utils.getCallbackWrapper(C.failure||LABKEY.Utils.displayAjaxErrorResponse,this,true)})},getVialsByRowId:function(C){if(C&&(LABKEY.Utils.isFunction(C)||arguments.length>1)){C={success:arguments[0],vialRowIdArray:arguments[1],failure:arguments[2],containerPath:arguments[3]}}B({url:LABKEY.ActionURL.buildURL("study-samples-api","getVialsByRowId",C.containerPath),success:A(C.success,"vials"),failure:LABKEY.Utils.getCallbackWrapper(C.failure||LABKEY.Utils.displayAjaxErrorResponse,this,true),jsonData:{rowIds:C.vialRowIdArray}})},getOpenRequests:function(C){if(C&&(LABKEY.Utils.isFunction(C)||arguments.length>1)){C={success:arguments[0],allUsers:arguments[1],failure:arguments[2],containerPath:arguments[3]}}if(!C.failure){C.failure=function(E,D){return LABKEY.Utils.displayAjaxErrorResponse(D,E)}}B({url:LABKEY.ActionURL.buildURL("study-samples-api","getOpenRequests",C.containerPath),success:A(C.success,"requests"),failure:LABKEY.Utils.getCallbackWrapper(C.failure,this,true),jsonData:{allUsers:C.allUsers}})},getProvidingLocations:function(C){if(C&&(LABKEY.Utils.isFunction(C)||arguments.length>1)){C={success:arguments[0],specimenHashArray:arguments[1],failure:arguments[2],containerPath:arguments[3]}}if(!C.failure){C.failure=function(E,D){return LABKEY.Utils.displayAjaxErrorResponse(D,E)}}B({url:LABKEY.ActionURL.buildURL("study-samples-api","getProvidingLocations",C.containerPath),success:A(C.success,"locations"),failure:LABKEY.Utils.getCallbackWrapper(C.failure,this,true),jsonData:{specimenHashes:C.specimenHashArray}})},getVialTypeSummary:function(C){if(!C.failure){C.failure=function(E,D){return LABKEY.Utils.displayAjaxErrorResponse(D,E)}}B({url:LABKEY.ActionURL.buildURL("study-samples-api","getVialTypeSummary",C.containerPath),success:A(C.success),failure:LABKEY.Utils.getCallbackWrapper(C.failure,this,true)})},getSpecimenWebPartGroups:function(C){if(!C.failure){C.failure=function(E,D){return LABKEY.Utils.displayAjaxErrorResponse(D,E)}}B({url:LABKEY.ActionURL.buildURL("study-samples-api","getSpecimenWebPartGroups",C.containerPath),success:A(C.success),failure:LABKEY.Utils.getCallbackWrapper(C.failure,this,true)})},getRequest:function(C){if(C&&LABKEY.Utils.isFunction(C)||arguments.length>1){C={success:arguments[0],requestId:arguments[1],failure:arguments[2],containerPath:arguments[3]}}if(!C.failure){C.failure=function(E,D){return LABKEY.Utils.displayAjaxErrorResponse(D,E)}}B({url:LABKEY.ActionURL.buildURL("study-samples-api","getRequest",C.containerPath),success:A(C.success,"request"),failure:LABKEY.Utils.getCallbackWrapper(C.failure,this,true),jsonData:{requestId:C.requestId}})},cancelRequest:function(C){if(C&&(LABKEY.Utils.isFunction(C)||arguments.length>1)){C={success:arguments[0],requestId:arguments[1],failure:arguments[2],containerPath:arguments[3]}}if(!C.failure){C.failure=function(E,D){return LABKEY.Utils.displayAjaxErrorResponse(D,E)}}B({url:LABKEY.ActionURL.buildURL("study-samples-api","cancelRequest",C.containerPath),success:A(C.success),failure:LABKEY.Utils.getCallbackWrapper(C.failure,this,true),jsonData:{requestId:C.requestId}})},addVialsToRequest:function(C){if(C&&(LABKEY.Utils.isFunction(C)||arguments.length>1)){C={success:arguments[0],requestId:arguments[1],vialIdArray:arguments[2],idType:arguments[3],failure:arguments[4],containerPath:arguments[5]}}if(!C.failure){C.failure=function(E,D){return LABKEY.Utils.displayAjaxErrorResponse(D,E)}}if(!C.idType){C.idType="GlobalUniqueId"}B({url:LABKEY.ActionURL.buildURL("study-samples-api","addVialsToRequest",C.containerPath),success:A(C.success),failure:LABKEY.Utils.getCallbackWrapper(C.failure,this,true),jsonData:{requestId:C.requestId,vialIds:C.vialIdArray,idType:C.idType}})},addSamplesToRequest:function(D){if(D&&(LABKEY.Utils.isFunction(D)||arguments.length>1)){D={success:arguments[0],requestId:arguments[1],specimenHashArray:arguments[2],preferredLocation:arguments[3],failure:arguments[4],containerPath:arguments[5]}}var C=LABKEY.Utils.getOnFailure(D);var E=LABKEY.Utils.getOnSuccess(D);if(!C){C=function(G,F){return LABKEY.Utils.displayAjaxErrorResponse(F,G)}}B({url:LABKEY.ActionURL.buildURL("study-samples-api","addSamplesToRequest",D.containerPath),success:A(E),failure:LABKEY.Utils.getCallbackWrapper(C,this,true),jsonData:{requestId:D.requestId,specimenHashes:D.specimenHashArray,preferredLocation:D.preferredLocation}})},removeVialsFromRequest:function(C){if(C&&(LABKEY.Utils.isFunction(C)||arguments.length>1)){C={success:arguments[0],requestId:arguments[1],vialIdArray:arguments[2],idType:arguments[3],failure:arguments[4],containerPath:arguments[5]}}if(!C.failure){C.failure=function(E,D){return LABKEY.Utils.displayAjaxErrorResponse(D,E)}}if(!C.idType){C.idType="GlobalUniqueId"}B({url:LABKEY.ActionURL.buildURL("study-samples-api","removeVialsFromRequest",C.containerPath),success:A(C.success),failure:LABKEY.Utils.getCallbackWrapper(C.failure,this,true),jsonData:{requestId:C.requestId,vialIds:C.vialIdArray,idType:C.idType}})}}};LABKEY.Query.Visualization=new function(){function C(D){var E={};if(D.filters&&D.filters.length){E.filters=D.filters}if(D.dateMeasures!==undefined){E.dateMeasures=D.dateMeasures}if(D.allColumns!==undefined){E.allColumns=D.allColumns}if(D.showHidden!==undefined){E.showHidden=D.showHidden}return E}function A(D,E){return function(I,F,G){var H=null;if(I&&I.getResponseHeader&&I.getResponseHeader("Content-Type")&&I.getResponseHeader("Content-Type").indexOf("application/json")>=0){H=LABKEY.ExtAdapter.decode(I.responseText);if(H.visualizationConfig){H.visualizationConfig=LABKEY.ExtAdapter.decode(H.visualizationConfig)}}if(D){D.call(E||this,H,F,G)}}}function B(F,E,D){return function(G,H){var I=null;var J=null;if(G&&G.getResponseHeader&&G.getResponseHeader("Content-Type")&&G.getResponseHeader("Content-Type").indexOf("application/json")>=0){I=LABKEY.ExtAdapter.decode(G.responseText);J=F(I)}if(E){E.call(D||this,J,G)}}}return{getTypes:function(D){function E(F){if(F.types&&F.types.length){return F.types}return[]}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","getVisualizationTypes"),method:"GET",success:B(E,LABKEY.Utils.getOnSuccess(D),D.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(D),D.scope,true)})},getMeasures:function(D){function E(H){var I=[];if(H.measures&&H.measures.length){for(var G=0;G<H.measures.length;G++){I.push(new LABKEY.Query.Visualization.Measure(H.measures[G]))}}return I}var F=C(D);LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","getMeasures"),method:"GET",success:B(E,LABKEY.Utils.getOnSuccess(D),D.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(D),D.scope,true),params:F})},getData:function(D){var E={measures:D.measures,sorts:D.sorts,filterUrl:D.filterUrl,filterQuery:D.filterQuery,limit:D.limit,groupBys:D.groupBys};LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","getData"),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(D),D.scope,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(D),D.scope,true),jsonData:E,headers:{"Content-Type":"application/json"}})},save:function(D){var E={name:D.name,description:D.description,json:LABKEY.ExtAdapter.encode(D.visualizationConfig),replace:D.replace,shared:D.shared,thumbnailType:D.thumbnailType,svg:D.svg,type:D.type,schemaName:D.schemaName,queryName:D.queryName};LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","saveVisualization"),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(D),D.scope,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(D),D.scope,true),jsonData:E,headers:{"Content-Type":"application/json"}})},get:function(E){var F={reportId:E.reportId,name:E.name,schemaName:E.schemaName,queryName:E.queryName};var D=LABKEY.Utils.getOnSuccess(E);D=A(D,E.scope);LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","getVisualization"),method:"POST",initialConfig:E,success:D,failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(E),E.scope,true),jsonData:F,headers:{"Content-Type":"application/json"}})},getFromUrl:function(E){var G=E||{};G.success=LABKEY.Utils.getOnSuccess(E);G.failure=LABKEY.Utils.getOnFailure(E);var D=LABKEY.ActionURL.getParameters();var F=false;if(G.reportId){F=true}else{if(D.name){G.name=D.name;G.schemaName=D.schemaName;G.queryName=D.queryName;F=true}}if(F){LABKEY.Query.Visualization.get(G)}return F},getDataFilterFromURL:function(){var D=LABKEY.ActionURL.getParameters();return D.filterUrl}}};LABKEY.Visualization=LABKEY.Query.Visualization;Ext4.define("LABKEY.Query.Visualization.Measure",{constructor:function(A){Ext4.apply(this,A)},getQueryName:function(){return this.queryName},getSchemaName:function(){return this.schemaName},isUserDefined:function(){return this.isUserDefined},getName:function(){return this.name},getLabel:function(){return this.label},getType:function(){return this.type},getDescription:function(){return this.description},getDimensions:function(A){var C={queryName:this.queryName,schemaName:this.schemaName};if(A.includeDemographics){C.includeDemographics=A.includeDemographics}function B(E){var F=[];if(E.dimensions&&E.dimensions.length){for(var D=0;D<E.dimensions.length;D++){F.push(new LABKEY.Query.Visualization.Dimension(E.dimensions[D]))}}return F}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","getDimensions"),method:"GET",params:C,success:getSuccessCallbackWrapper(B,LABKEY.Utils.getOnSuccess(A),A.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(A),A.scope,true)})}});LABKEY.Visualization.Measure=LABKEY.Query.Visualization.Measure;Ext4.define("LABKEY.Query.Visualization.Dimension",{constructor:function(A){Ext4.apply(this,A)},getQueryName:function(){return this.queryName},getSchemaName:function(){return this.schemaName},isUserDefined:function(){return this.isUserDefined},getName:function(){return this.name},getLabel:function(){return this.label},getType:function(){return this.type},getDescription:function(){return this.description},getValues:function(B){var C={queryName:this.queryName,schemaName:this.schemaName,name:this.name};function A(D){if(D.success&&D.values){return D.values}return[]}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","getDimensionValues"),method:"GET",params:C,success:getSuccessCallbackWrapper(A,LABKEY.Utils.getOnSuccess(B),B.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(B),B.scope,true)})}});LABKEY.Visualization.Dimension=LABKEY.Query.Visualization.Dimension;LABKEY.Query.Visualization.Filter=new function(){function A(B){var C=[B.schemaName];if(B.queryName){C.push(B.queryName)}else{C.push("~")}if(B.queryType){C.push(B.queryType)}return C.join("|")}return{QueryType:{BUILT_IN:"builtIn",CUSTOM:"custom",DATASETS:"datasets",ALL:"all"},create:function(B){if(!B.schemaName){Ext4.Msg.alert("Coding Error!","You must supply a value for schemaName in your configuration object!")}else{return A(B)}}}};LABKEY.Visualization.Filter=LABKEY.Query.Visualization.Filter;LABKEY.Query.Visualization.Aggregate={SUM:"SUM",AVG:"AVG",COUNT:"COUNT",MIN:"MIN",MAX:"MAX"};LABKEY.Visualization.Aggregate=LABKEY.Query.Visualization.Aggregate;LABKEY.Query.Visualization.Interval={DAY:"DAY",WEEK:"WEEK",MONTH:"MONTH",YEAR:"YEAR"};LABKEY.Visualization.Interval=LABKEY.Query.Visualization.Interval;LABKEY.Query.Visualization.Type={TimeChart:"ReportService.TimeChartReport"};LABKEY.Visualization.Type=LABKEY.Query.Visualization.Type;LABKEY.WebPart=function(E){var K=E.renderTo;var N=E.partName;var H=E.frame;var M=E.bodyClass;var O=E.title;var D=E.titleHref;var A=E.partConfig;var B=LABKEY.Utils.getOnFailure(E);var L=LABKEY.Utils.getOnSuccess(E);var J=E.containerPath;var C=E.scope||this;var G=E.supressRenderErrors;if(!N){LABKEY.ExtAdapter.Msg.alert("Configuration Error","You must supply the name of the desired web part in the partName config property.");return }if(!K){LABKEY.ExtAdapter.Msg.alert("Configuration Error","You must supply the name of the target element in the renderTo config property.");return }var F=function(P,Q){var S="Error getting the web part: ";if(P.status==0){return }if(P.status>=500&&P.status<600){var R=LABKEY.ExtAdapter.decode(P.responseText);if(R){S+=R.exception}}else{S+=P.statusText}LABKEY.ExtAdapter.Msg.alert("Error",S)};var I=function(P,Q){if(Q.params.beforeRender){var R=Q.params.beforeRender.call(C,P);if(R===false){return }else{if(R){P=R}}}if(K){var S=LABKEY.ExtAdapter.get(K);if(S){LABKEY.Utils.loadAjaxContent(P,S,L,C)}else{if(!G){LABKEY.ExtAdapter.Msg.alert("Rendering Error","The element '"+K+"' does not exist in the document!")}}}else{if(!G){LABKEY.ExtAdapter.Msg.alert("Rendering Error","The target element name was not set!")}}};return{render:function(){if(!A){A={}}A["webpart.name"]=N;if(H){A["webpart.frame"]=H}if(M){A["webpart.bodyClass"]=M}if(O){A["webpart.title"]=O}if(D){A["webpart.titleHref"]=D}A.returnURL=encodeURI(A.returnURL||(window.location.pathname+window.location.search));if(!B){B=F}LABKEY.ExtAdapter.applyIf(A,LABKEY.ActionURL.getParameters());delete A._dc;return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("project","getWebPart",J),success:I,failure:B,method:"GET",params:A})}}};LABKEY.WebPart.createReportWebpart=function(A){var B=LABKEY.ExtAdapter.apply({},A.webPartConfig);B.partName="Report";var C;LABKEY.ExtAdapter.each(["renderTo","success","failure"],function(D){if(LABKEY.ExtAdapter.isDefined(A[D])){B[D]=A[D]}},this);B.partConfig=LABKEY.ExtAdapter.apply({},A.reportProperties);LABKEY.ExtAdapter.each(["reportId","reportName","schemaName","queryName","title"],function(D){if(LABKEY.ExtAdapter.isDefined(A[D])){B.partConfig[D]=A[D]}},this);return new LABKEY.WebPart(B)};(function(){var A=function(G){var H={};if(G instanceof LABKEY.Query.Filter||G.getColumnName){H.fieldKey=LABKEY.FieldKey.fromString(G.getColumnName()).getParts();H.value=G.getValue();H.type=G.getFilterType().getURLSuffix();return H}if(G.fieldKey){G.fieldKey=D(G.fieldKey)}else{throw new Error('All filters must have a "fieldKey" attribute.')}if(!G.fieldKey){throw new Error("Filter fieldKeys must be valid FieldKeys")}if(!G.type){throw new Error('All filters must have a "type" attribute.')}return G};var D=function(G){if(G instanceof LABKEY.FieldKey){return G.getParts()}if(G instanceof Array){return G}if(typeof G==="string"){return LABKEY.FieldKey.fromString(G).getParts()}return false};var C=function(G){if(!G||G==null){throw new Error("A source is required for a GetData request.")}if(!G.type){G.type="query"}if(!G.schemaName){throw new Error("A schemaName is required.")}G.schemaName=D(G.schemaName);if(!G.schemaName){throw new Error("schemaName must be a FieldKey")}if(G.type==="query"){if(!G.queryName||G.queryName==null){throw new Error('A queryName is required for getData requests with type = "query"')}}else{if(G.type==="sql"){if(!G.sql){throw new Error('sql is required if source.type = "sql"')}}else{throw new Error("Unsupported source type.")}}};var F=function(G){if(!G.columns||G.columns==null){throw new Error("pivot.columns is required.")}if(!G.columns instanceof Array){throw new Error("pivot.columns must be an array of fieldKeys.")}for(var H=0;H<G.columns.length;H++){G.columns[H]=D(G.columns[H]);if(!G.columns[H]){throw new Error("pivot.columns must be an array of fieldKeys.")}}if(!G.by||G.by==null){throw new Error("pivot.by is required")}G.by=D(G.by);if(!G.by===false){throw new Error("pivot.by must be a fieldKey.")}};var E=function(G){var H;if(!G.type||G.type!=="aggregate"){G.type="aggregate"}if(G.groupBy&&G.groupBy!=null){if(!G.groupBy instanceof Array){throw new Error("groupBy must be an array.")}}if(G.aggregates&&G.aggregates!=null){if(!G.aggregates instanceof Array){throw new Error("aggregates must be an array.")}for(H=0;H<G.aggregates.length;H++){if(!G.aggregates[H].fieldKey){throw new Error("All aggregates must include a fieldKey.")}G.aggregates[H].fieldKey=D(G.aggregates[H].fieldKey);if(!G.aggregates[H].fieldKey){throw new Error("Aggregate fieldKeys must be valid fieldKeys")}if(!G.aggregates[H].type){throw new Error("All aggregates must include a type.")}}}if(G.filters&&G.filters!=null){if(!G.filters instanceof Array){throw new Error("The filters of a transform must be an array.")}for(H=0;H<G.filters.length;H++){G.filters[H]=A(G.filters[H])}}};var B=function(G){if(!G||G===null||G===undefined){throw new Error("A config object is required for GetData requests.")}var I={renderer:{}};var H;C(G.source);I.source={type:G.source.type,schemaName:G.source.schemaName};if(G.source.type==="query"){I.source.queryName=G.source.queryName}if(G.source.type==="sql"){I.source.sql=G.source.sql}if(G.transforms){if(!(G.transforms instanceof Array)){throw new Error("transforms must be an array.")}I.transforms=G.transforms;for(H=0;H<I.transforms.length;H++){E(I.transforms[H])}}if(G.pivot){F(G.pivot)}if(G.columns){if(!(G.columns instanceof Array)){throw new Error("columns must be an array of FieldKeys.")}for(H=0;H<G.columns.length;H++){G.columns[H]=D(G.columns[H]);if(!G.columns[H]){throw new Error("columns must be an array of FieldKeys.")}}I.renderer.columns=G.columns}if(G.hasOwnProperty("offset")){I.renderer.offset=G.offset}if(G.hasOwnProperty("includeDetailsColumn")){I.renderer.includeDetailsColumn=G.includeDetailsColumn}if(G.hasOwnProperty("maxRows")){I.renderer.maxRows=G.maxRows}if(G.sort){if(!(G.sort instanceof Array)){throw new Error("sort must be an array.")}for(H=0;H<G.sort.length;H++){if(!G.sort[H].fieldKey){throw new Error("Each sort must specify a field key.")}G.sort[H].fieldKey=D(G.sort[H].fieldKey);if(!G.sort[H].fieldKey){throw new Error("Invalid field key specified for sort.")}if(G.sort[H].dir){G.sort[H].dir=G.sort[H].dir.toUpperCase()}}I.renderer.sort=G.sort}return I};LABKEY.Query.GetData={getRawData:function(H){var I=B(H);I.renderer.type="json";var G={method:"POST",url:LABKEY.ActionURL.buildURL("query","getData",H.source.containerPath),jsonData:I};if(!H.failure){G.failure=function(J,K){if(J.status!=0){var L=LABKEY.ExtAdapter.decode(J.responseText);console.error("Failure occurred during getData",L)}}}else{G.failure=function(J,K){var L=LABKEY.ExtAdapter.decode(J.responseText);H.failure(L)}}if(!H.success){throw new Error("A success callback is required.")}if(!H.scope){H.scope=this}G.success=function(J,K){var L=LABKEY.ExtAdapter.decode(J.responseText);var M=new LABKEY.Query.Response(L);H.success.call(H.scope,M,J,K)};return new LABKEY.Ajax.request(G)},renderQueryWebPart:function(H){var I=B(H);I.renderer.type="json";I.renderer.maxRows=0;if(!H.webPartConfig){throw new Error("A webPartConfig object is required.")}var G={method:"POST",url:LABKEY.ActionURL.buildURL("query","getData",H.source.containerPath),jsonData:I,success:function(J){var K=LABKEY.ExtAdapter.decode(J.responseText);H.webPartConfig.schemaName=H.source.schemaName;H.webPartConfig.queryName=K.queryName;new LABKEY.QueryWebPart(H.webPartConfig)},failure:function(J,K){if(J.status!=0){LABKEY.Utils.displayAjaxErrorResponse(J,null,true,"Error during GetData call")}}};LABKEY.Ajax.request(G)}}})();